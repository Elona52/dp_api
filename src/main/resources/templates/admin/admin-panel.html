<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Management Page</title>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/auction.css}">
    <link rel="stylesheet" th:href="@{/css/kamco.css}">
    
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: 'Nanum Gothic', 'Malgun Gothic', sans-serif;
            background: #f5f5f5;
        }

        body {
            padding: 20px;
        }
        
        .button-bar {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            background: #f9f9f9;
        }
        
        .button-bar button {
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #666;
            background: white;
            font-size: 14px;
        }
        
        .button-bar button:hover {
            background: #f0f0f0;
        }
        
        .content-area {
            border: 1px solid #ddd;
            padding: 20px;
            min-height: 400px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 13px;
            border-radius: 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            white-space: nowrap;
            border-radius: 0;
        }
        
        th {
            background: #f0f0f0;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        pre {
            background: #f5f5f5;
            padding: 10px;
            overflow-x: auto;
            border: 1px solid #ddd;
        }
        
        .member-actions button {
            margin-right: 5px;
            padding: 4px 8px;
            font-size: 12px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
        }
    </style>
</head>
<body>

<!-- =================== í—¤ë” =================== -->
<div th:replace="~{layout/header :: header}"></div>
    <h1>Admin Management Panel</h1>
    
    <!-- ìƒë‹¨ ë²„íŠ¼ ë°” -->
    <div class="button-bar">		
        <button onclick="unionNewItemsList()">API ì‹ ë¬¼ê±´ì¡°íšŒ</button>
        <button onclick="unionDiscountItemsList()">API ê°ê°€50%ì¡°íšŒ</button>
        <button onclick="unionUsageItemsList()">API ìš©ë„ë³„í†µí•©ì¡°íšŒ</button>
		
        <button onclick="itemNewItemsList()">DBì‹ ë¬¼ê±´ì¡°íšŒ</button>
        <button onclick="itemDiscountItemsList()">DB ê°ê°€50%ì¡°íšŒ</button>
        <button onclick="itemUsageItemsList()">DB ìš©ë„ë³„í†µí•©ì¡°íšŒ</button>

        <button onclick="saveNewItemsToDb()">ì‹ ë¬¼ê±´DBì €ì¥</button>
        <button onclick="saveDiscountItemsToDb()">ê°ê°€50%ë¬¼ê±´DBì €ì¥</button>
        <button onclick="saveUsageItemsToDb()">ìš©ë„ë³„í†µí•©ë¬¼ê±´DBì €ì¥</button>
        
        <button onclick="deleteNewItemsFromDb()">ì‹ ë¬¼ê±´DBì‚­ì œ</button>
        <button onclick="deleteDiscountItemsFromDb()">ê°ê°€50%ë¬¼ê±´DBì‚­ì œ</button>
        <button onclick="deleteUsageItemsFromDb()">ìš©ë„ë³„í†µí•©ë¬¼ê±´DBì‚­ì œ</button>
		
        <button onclick="memberList()">íšŒì›ëª©ë¡</button>
        <button onclick="boardList()">ê²Œì‹œê¸€ëª©ë¡</button>
    </div>
    
    <!-- í•˜ë‹¨ ë‚´ìš© í‘œì‹œ ì˜ì—­ -->
    <div class="content-area" id="contentArea">
        <p style="color: #999;">ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì—¬ê¸°ì— ë‚´ìš©ì´ í‘œì‹œë©ë‹ˆë‹¤.</p>
    </div>

    <script>
        const API_BASE = '/api/admin';
        
        // ì‹ ë¬¼ê±´ DB ì €ì¥ (ItemRestControllerë¥¼ í†µí•œ ì²˜ë¦¬)
        function saveNewItemsToDb() {
            if (!confirm('ì‹ ë¬¼ê±´ì„ DBì— ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nItemRestControllerë¥¼ í†µí•´ ApiServiceë¡œ ì—¬ëŸ¬ í˜ì´ì§€ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì €ì¥í•©ë‹ˆë‹¤. ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) return;
            
            let html = '<h2>ì‹ ë¬¼ê±´ DB ì €ì¥</h2>';
            html += '<div id="saveNewItemsResultArea" style="margin-top:20px;">';
            html += '<p style="color:#27ae60; font-weight:bold;">âœ¨ ì‹ ë¬¼ê±´ ì €ì¥ ì¤‘...</p>';
            html += '<p>ItemRestControllerë¥¼ í†µí•´ ApiServiceë¡œ APIì—ì„œ ì‹ ë¬¼ê±´ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ DBì— ì €ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>';
            html += '<p style="color:#666; font-size:12px;">ì§„í–‰ ìƒí™©ì€ ì„œë²„ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>';
            html += '</div>';
            document.getElementById('contentArea').innerHTML = html;
            
            const startTime = Date.now();
            
            // ItemRestControllerë¥¼ í†µí•œ ì¼ê´„ ì €ì¥ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
            fetch('/items/api/batch-save-new-items', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    sido: 'ì„œìš¸íŠ¹ë³„ì‹œ'
                })
            })
                .then(r => r.json())
                .then(data => {
                    const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = (elapsed % 60).toFixed(1);
                    const timeText = minutes > 0 ? minutes + 'ë¶„ ' + seconds + 'ì´ˆ' : elapsed + 'ì´ˆ';
                    
                    let resultHtml = '<p style="color: green; font-weight:bold;">âœ… ì‹ ë¬¼ê±´ ì €ì¥ ì™„ë£Œ! (ì†Œìš” ì‹œê°„: ' + timeText + ')</p>';
                    resultHtml += '<p style="color: green;">ì´ ì €ì¥ëœ ê°œìˆ˜: ' + (data.savedCount || 0) + 'ê±´</p>';
                    resultHtml += '<pre style="background:#f5f5f5; padding:10px; border-radius:5px; overflow:auto;">' + JSON.stringify(data, null, 2) + '</pre>';
                    document.getElementById('saveNewItemsResultArea').innerHTML = resultHtml;
                })
                .catch(error => {
                    const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                    document.getElementById('saveNewItemsResultArea').innerHTML = 
                        '<p style="color: red; font-weight:bold;">âŒ ì‹ ë¬¼ê±´ ì €ì¥ ì‹¤íŒ¨ (ì†Œìš” ì‹œê°„: ' + elapsed + 'ì´ˆ)</p>' +
                        '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                    console.error('ì‹ ë¬¼ê±´ ì €ì¥ ì˜¤ë¥˜:', error);
                });
        }
        
        // ê°ê°€50%ë¬¼ê±´ DB ì €ì¥ (ItemRestControllerë¥¼ í†µí•œ ì²˜ë¦¬)
        function saveDiscountItemsToDb() {
            if (!confirm('ê°ê°€50%ë¬¼ê±´ì„ DBì— ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nItemRestControllerë¥¼ í†µí•´ ApiServiceë¡œ ì—¬ëŸ¬ í˜ì´ì§€ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì €ì¥í•©ë‹ˆë‹¤. ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) return;
            
            let html = '<h2>ê°ê°€50%ë¬¼ê±´ DB ì €ì¥</h2>';
            html += '<div id="saveDiscountItemsResultArea" style="margin-top:20px;">';
            html += '<p style="color:#e67e22; font-weight:bold;">ğŸ’° ê°ê°€50%ë¬¼ê±´ ì €ì¥ ì¤‘...</p>';
            html += '<p>ItemRestControllerë¥¼ í†µí•´ ApiServiceë¡œ APIì—ì„œ ê°ê°€50%ë¬¼ê±´ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ DBì— ì €ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>';
            html += '<p style="color:#666; font-size:12px;">ì§„í–‰ ìƒí™©ì€ ì„œë²„ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>';
            html += '</div>';
            document.getElementById('contentArea').innerHTML = html;
            
            const startTime = Date.now();
            
            // ItemRestControllerë¥¼ í†µí•œ ì¼ê´„ ì €ì¥ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
            fetch('/items/api/batch-save-discount-items', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    sido: 'ì„œìš¸íŠ¹ë³„ì‹œ'
                })
            })
                .then(r => r.json())
                .then(data => {
                    const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = (elapsed % 60).toFixed(1);
                    const timeText = minutes > 0 ? minutes + 'ë¶„ ' + seconds + 'ì´ˆ' : elapsed + 'ì´ˆ';
                    
                    let resultHtml = '<p style="color: green; font-weight:bold;">âœ… ê°ê°€50%ë¬¼ê±´ ì €ì¥ ì™„ë£Œ! (ì†Œìš” ì‹œê°„: ' + timeText + ')</p>';
                    resultHtml += '<p style="color: green;">ì´ ì €ì¥ëœ ê°œìˆ˜: ' + (data.savedCount || 0) + 'ê±´</p>';
                    resultHtml += '<pre style="background:#f5f5f5; padding:10px; border-radius:5px; overflow:auto;">' + JSON.stringify(data, null, 2) + '</pre>';
                    document.getElementById('saveDiscountItemsResultArea').innerHTML = resultHtml;
                })
                .catch(error => {
                    const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                    document.getElementById('saveDiscountItemsResultArea').innerHTML = 
                        '<p style="color: red; font-weight:bold;">âŒ ê°ê°€50%ë¬¼ê±´ ì €ì¥ ì‹¤íŒ¨ (ì†Œìš” ì‹œê°„: ' + elapsed + 'ì´ˆ)</p>' +
                        '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                    console.error('ê°ê°€50%ë¬¼ê±´ ì €ì¥ ì˜¤ë¥˜:', error);
                });
        }
        
        // ìš©ë„ë³„í†µí•©ë¬¼ê±´ DB ì €ì¥ (ItemRestControllerë¥¼ í†µí•œ ì²˜ë¦¬)
        function saveUsageItemsToDb() {
            if (!confirm('ìš©ë„ë³„í†µí•©ë¬¼ê±´ì„ DBì— ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nItemRestControllerë¥¼ í†µí•´ ApiServiceë¡œ ì—¬ëŸ¬ í˜ì´ì§€ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì €ì¥í•©ë‹ˆë‹¤. ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) return;
            
            let html = '<h2>ìš©ë„ë³„í†µí•©ë¬¼ê±´ DB ì €ì¥</h2>';
            html += '<div id="saveUsageItemsResultArea" style="margin-top:20px;">';
            html += '<p style="color:#3498db; font-weight:bold;">ğŸ“‹ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì €ì¥ ì¤‘...</p>';
            html += '<p>ItemRestControllerë¥¼ í†µí•´ ApiServiceë¡œ APIì—ì„œ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ DBì— ì €ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>';
            html += '<p style="color:#666; font-size:12px;">ì§„í–‰ ìƒí™©ì€ ì„œë²„ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>';
            html += '</div>';
            document.getElementById('contentArea').innerHTML = html;
            
            const startTime = Date.now();
            
            // ItemRestControllerë¥¼ í†µí•œ ì¼ê´„ ì €ì¥ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
            fetch('/items/api/batch-save-usage-items', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    sido: 'ì„œìš¸íŠ¹ë³„ì‹œ'
                })
            })
                .then(r => r.json())
                .then(data => {
                    const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = (elapsed % 60).toFixed(1);
                    const timeText = minutes > 0 ? minutes + 'ë¶„ ' + seconds + 'ì´ˆ' : elapsed + 'ì´ˆ';
                    
                    let resultHtml = '<p style="color: green; font-weight:bold;">âœ… ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì €ì¥ ì™„ë£Œ! (ì†Œìš” ì‹œê°„: ' + timeText + ')</p>';
                    resultHtml += '<p style="color: green;">ì´ ì €ì¥ëœ ê°œìˆ˜: ' + (data.savedCount || 0) + 'ê±´</p>';
                    resultHtml += '<pre style="background:#f5f5f5; padding:10px; border-radius:5px; overflow:auto;">' + JSON.stringify(data, null, 2) + '</pre>';
                    document.getElementById('saveUsageItemsResultArea').innerHTML = resultHtml;
                })
                .catch(error => {
                    const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                    document.getElementById('saveUsageItemsResultArea').innerHTML = 
                        '<p style="color: red; font-weight:bold;">âŒ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì €ì¥ ì‹¤íŒ¨ (ì†Œìš” ì‹œê°„: ' + elapsed + 'ì´ˆ)</p>' +
                        '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                    console.error('ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì €ì¥ ì˜¤ë¥˜:', error);
                });
        }
        
        // Union íŒ¨í‚¤ì§€ ê¸°ëŠ¥ (200ê±´ì”© í˜ì´ì§€ë„¤ì´ì…˜)
        const UNION_PAGE_SIZE = 200;
        
        // Union ì‹ ë¬¼ê±´ ì¡°íšŒ - ì›ë³¸ API ì‘ë‹µ í‘œì‹œ
        function unionNewItemsList(page = 1) {
            showLoading();
            
            // ApiServiceì—ì„œ ì§ì ‘ ì›ë³¸ API í˜¸ì¶œ
            fetch(API_BASE + '/api-raw/new-items?page=' + page + '&sido=ì„œìš¸íŠ¹ë³„ì‹œ')
                .then(r => r.json())
                .then(data => {
                    if (data.success && data.xmlResponse) {
                        renderRawApiResponse(page, data.xmlResponse, 'ì‹ ë¬¼ê±´ ì›ë³¸ API ì‘ë‹µ', 'unionNewItemsList');
                            } else {
                        document.getElementById('contentArea').innerHTML = 
                            '<h2>Union ì‹ ë¬¼ê±´ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>Union ì‹ ë¬¼ê±´ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // Union ê°ê°€ 50% ì´ìƒ ì¡°íšŒ - ì›ë³¸ API ì‘ë‹µ í‘œì‹œ
        function unionDiscountItemsList(page = 1) {
            showLoading();
            
            // ApiServiceì—ì„œ ì§ì ‘ ì›ë³¸ API í˜¸ì¶œ
            fetch(API_BASE + '/api-raw/discount-items?page=' + page + '&sido=ì„œìš¸íŠ¹ë³„ì‹œ')
                .then(r => r.json())
                .then(data => {
                    if (data.success && data.xmlResponse) {
                        renderRawApiResponse(page, data.xmlResponse, 'ê°ê°€ 50% ì´ìƒ ì›ë³¸ API ì‘ë‹µ', 'unionDiscountItemsList');
                            } else {
                        document.getElementById('contentArea').innerHTML = 
                            '<h2>Union ê°ê°€ 50% ì´ìƒ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>Union ê°ê°€ 50% ì´ìƒ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // Union ìš©ë„ë³„ í†µí•© ì¡°íšŒ - ì›ë³¸ API ì‘ë‹µ í‘œì‹œ
        function unionUsageItemsList(page = 1) {
            showLoading();
            
            // ApiServiceì—ì„œ ì§ì ‘ ì›ë³¸ API í˜¸ì¶œ
            fetch(API_BASE + '/api-raw/usage-items?page=' + page + '&sido=ì„œìš¸íŠ¹ë³„ì‹œ')
                .then(r => r.json())
                .then(data => {
                    if (data.success && data.xmlResponse) {
                        renderRawApiResponse(page, data.xmlResponse, 'ìš©ë„ë³„ í†µí•© ì›ë³¸ API ì‘ë‹µ', 'unionUsageItemsList');
                    } else {
                        document.getElementById('contentArea').innerHTML = 
                            '<h2>Union ìš©ë„ë³„ í†µí•© ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>Union ìš©ë„ë³„ í†µí•© ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // ì›ë³¸ API ì‘ë‹µ ë Œë”ë§ í•¨ìˆ˜
        function renderRawApiResponse(page, xmlResponse, title, functionName) {
            let html = '<h2>' + title + '</h2>';
            html += '<p style="color: #666; font-size: 14px;">í˜ì´ì§€: ' + page + ' | ApiServiceì—ì„œ ì§ì ‘ í˜¸ì¶œí•œ ì›ë³¸ XML ì‘ë‹µ</p>';
            
            // XMLì„ ë³´ê¸° ì¢‹ê²Œ í¬ë§·íŒ… (ê°„ë‹¨í•œ ì²˜ë¦¬)
            let formattedXml = xmlResponse;
            try {
                // XMLì„ ë³´ê¸° ì¢‹ê²Œ í¬ë§·íŒ… ì‹œë„
                formattedXml = formatXml(xmlResponse);
            } catch (e) {
                // í¬ë§·íŒ… ì‹¤íŒ¨ ì‹œ ì›ë³¸ ê·¸ëŒ€ë¡œ í‘œì‹œ
                formattedXml = xmlResponse;
            }
            
            html += '<div style="margin: 20px 0;">';
            html += '<button onclick="' + functionName + '(' + (page - 1) + ')" style="padding: 8px 15px; margin: 5px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">ì´ì „ í˜ì´ì§€</button>';
            html += '<button onclick="' + functionName + '(' + (page + 1) + ')" style="padding: 8px 15px; margin: 5px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">ë‹¤ìŒ í˜ì´ì§€</button>';
            html += '<span style="margin-left: 20px; color: #666;">í˜„ì¬ í˜ì´ì§€: ' + page + '</span>';
            html += '</div>';
            
            html += '<div style="background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; max-height: 800px; overflow-y: auto; border: 1px solid #ddd;">';
            html += '<pre style="margin: 0; white-space: pre-wrap; word-wrap: break-word; font-family: \'Courier New\', monospace; font-size: 12px;">';
            html += escapeHtml(formattedXml);
            html += '</pre>';
                    html += '</div>';
            
            document.getElementById('contentArea').innerHTML = html;
        }
        
        // XML í¬ë§·íŒ… í•¨ìˆ˜ (ê°„ë‹¨í•œ ë²„ì „)
        function formatXml(xml) {
            let formatted = '';
            let indent = 0;
            const tab = '  ';
            
            xml.split(/>\s*</).forEach(function(node) {
                if (node.match(/^\/\w/)) indent--;
                formatted += tab.repeat(indent < 0 ? 0 : indent) + '<' + node + '>\r\n';
                if (node.match(/^<?\w[^>]*[^\/]$/) && !node.startsWith('input')) indent++;
            });
            
            return formatted.substring(1, formatted.length - 2);
        }
        
        // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }
        
        // Union ëª©ë¡ í…Œì´ë¸” ë Œë”ë§ (ê³µí†µ í•¨ìˆ˜)
        function renderUnionListTable(page, pageItems, totalCount, title, pageSize, functionName) {
            const totalPages = Math.ceil(totalCount / pageSize);
            
            let html = '<h2>' + title + '</h2>';
            html += '<p>í˜ì´ì§€ë‹¹ ' + pageSize + 'ê°œ - Union APIì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°</p>';
            html += '<button onclick="saveUnionPage(\'' + functionName + '\', ' + page + ')" style="padding: 8px 15px; margin: 5px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">í˜„ì¬ í˜ì´ì§€ DB ì €ì¥</button>';
            
            if (pageItems && pageItems.length > 0) {
                html += '<div style="overflow-x: auto;">';
                html += '<table><thead><tr>';
                html += '<th>ìˆœë²ˆ</th><th>ë¬¼ê±´ë²ˆí˜¸</th><th>ì…ì°°ë²ˆí˜¸</th><th>ê¸°ê´€ëª…</th><th>ì§‘í–‰ê¸°ê´€ë²ˆí˜¸</th>';
                html += '<th>ì†Œì¬ì§€</th><th>ì§€ë²ˆì£¼ì†Œ</th><th>ë„ë¡œëª…</th><th>ê±´ë¬¼ë²ˆí˜¸</th>';
                html += '<th>ë¬¼ê±´ëª…</th><th>ìì‚°êµ¬ë¶„</th>';
                html += '<th>ìµœì €ì…ì°°ê°€</th><th>ê°ì •í‰ê°€ì•¡</th>';
                html += '<th>ì…ì°°ì‹œì‘</th><th>ì…ì°°ì¢…ë£Œ</th><th>ì…ì°°íšŒì°¨</th><th>ì…ì°°íšŸìˆ˜</th>';
                html += '<th>ì²˜ë¶„ë°©ì‹</th><th>ì…ì°°ë°©ì‹</th><th>ìˆ˜ìˆ˜ë£Œìœ¨</th>';
                html += '<th>ìƒíƒœ</th><th>ì¡°íšŒìˆ˜</th>';
                html += '</tr></thead><tbody>';
                
                pageItems.forEach((item, index) => {
                    html += '<tr>';
                    const displayRnum = (page - 1) * pageSize + index + 1;
                    html += '<td>' + displayRnum + '</td>';
                    html += '<td>' + (item.plnmNo || '-') + '</td>';
                    html += '<td>' + (item.pbctNo || '-') + '</td>';
                    html += '<td>' + (item.orgName || '-') + '</td>';
                    html += '<td>' + (item.orgBaseNo || '-') + '</td>';
                    html += '<td style="max-width:150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.address || '-') + '</td>';
                    html += '<td style="max-width:150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.nmrAddress || '-') + '</td>';
                    html += '<td style="max-width:150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.roadName || '-') + '</td>';
                    html += '<td>' + (item.bldNo || '-') + '</td>';
                    html += '<td style="max-width:200px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.goodsDetail || '-') + '</td>';
                    html += '<td>' + (item.assetCategory || '-') + '</td>';
                    const minBidPrice = item.minBidPriceMax || item.minBidPriceMin;
                    html += '<td style="text-align:right;">' + (minBidPrice ? minBidPrice.toLocaleString() + 'ì›' : '-') + '</td>';
                    const appraisalAmount = item.appraisalAmountMax || item.appraisalAmountMin;
                    html += '<td style="text-align:right;">' + (appraisalAmount ? appraisalAmount.toLocaleString() + 'ì›' : '-') + '</td>';
                    html += '<td>' + formatDate2(item.bidStart) + '</td>';
                    html += '<td>' + formatDate2(item.bidEnd) + '</td>';
                    html += '<td>' + (item.bidRoundNo || '-') + '</td>';
                    html += '<td style="text-align:center; font-weight:bold; color:#e74c3c;">' + (item.bidCount || 1) + '</td>';
                    html += '<td>' + (item.disposalMethod || '-') + '</td>';
                    html += '<td>' + (item.bidMethod || '-') + '</td>';
                    html += '<td>' + (item.feeRate || '-') + '</td>';
                    html += '<td>' + (item.bidStatus || '-') + '</td>';
                    html += '<td>' + (item.viewCount || 0) + '</td>';
                    html += '</tr>';
                });
                
                html += '</tbody></table></div>';
                
                // í˜ì´ì§€ë„¤ì´ì…˜
                if (totalPages > 1) {
                    html += '<div style="margin-top: 20px; text-align: center;">';
                    html += '<div style="display: inline-block;">';
                    
                    if (page > 1) {
                        html += '<button onclick="' + functionName + '(' + (page - 1) + ')" style="padding: 8px 15px; margin: 0 5px;">ì´ì „</button>';
                    }
                    
                    const startPage = Math.max(1, page - 5);
                    const endPage = Math.min(totalPages, page + 5);
                    
                    if (startPage > 1) {
                        html += '<button onclick="' + functionName + '(1)" style="padding: 8px 15px; margin: 0 2px;">1</button>';
                        if (startPage > 2) html += '<span style="margin: 0 5px;">...</span>';
                    }
                    
                    for (let i = startPage; i <= endPage; i++) {
                        if (i === page) {
                            html += '<button onclick="' + functionName + '(' + i + ')" style="padding: 8px 15px; margin: 0 2px; background: #004098; color: white; font-weight: bold;">' + i + '</button>';
                        } else {
                            html += '<button onclick="' + functionName + '(' + i + ')" style="padding: 8px 15px; margin: 0 2px;">' + i + '</button>';
                        }
                    }
                    
                    if (endPage < totalPages) {
                        if (endPage < totalPages - 1) html += '<span style="margin: 0 5px;">...</span>';
                        html += '<button onclick="' + functionName + '(' + totalPages + ')" style="padding: 8px 15px; margin: 0 2px;">' + totalPages + '</button>';
                    }
                    
                    if (page < totalPages) {
                        html += '<button onclick="' + functionName + '(' + (page + 1) + ')" style="padding: 8px 15px; margin: 0 5px;">ë‹¤ìŒ</button>';
                    }
                    
                    html += '</div>';
                    html += '<p style="margin-top: 10px; color: #666;">í˜ì´ì§€ ' + page + ' / ' + totalPages + '</p>';
                    html += '</div>';
                }
            } else {
                html += '<p>ë°ì´í„° ì—†ìŒ</p>';
            }
            
            document.getElementById('contentArea').innerHTML = html;
        }
        
        // Union í˜ì´ì§€ ì €ì¥ í•¨ìˆ˜
        function saveUnionPage(functionName, page) {
            let endpoint = '';
            if (functionName === 'unionNewItemsList') {
                endpoint = '/api/union/new-items/save';
            } else if (functionName === 'unionDiscountItemsList') {
                endpoint = '/api/union/discount-items/save';
            } else if (functionName === 'unionUsageItemsList') {
                endpoint = '/api/union/usage-items/save';
            } else {
                alert('ì•Œ ìˆ˜ ì—†ëŠ” í•¨ìˆ˜ëª…ì…ë‹ˆë‹¤.');
                return;
            }
            
            if (!confirm('í˜„ì¬ í˜ì´ì§€(' + page + 'í˜ì´ì§€)ì˜ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            fetch(endpoint + '?page=' + page + '&sido=ì„œìš¸íŠ¹ë³„ì‹œ', {
                method: 'POST'
            })
                .then(r => r.text())
                .then(data => {
                    alert(data);
                    // ì €ì¥ í›„ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    if (functionName === 'unionNewItemsList') {
                        unionNewItemsList(page);
                    } else if (functionName === 'unionDiscountItemsList') {
                        unionDiscountItemsList(page);
                    } else if (functionName === 'unionUsageItemsList') {
                        unionUsageItemsList(page);
                    }
                })
                .catch(error => {
                    alert('ì €ì¥ ì‹¤íŒ¨: ' + error.message);
                });
        }
        
        // Item íŒ¨í‚¤ì§€ ê¸°ëŠ¥ (200ê±´ì”© í˜ì´ì§€ë„¤ì´ì…˜) - Unionê³¼ ë™ì¼
        const ITEM_PAGE_SIZE = 200;
        
        // Item ì‹ ë¬¼ê±´ ì¡°íšŒ (ItemRestControllerë¥¼ í†µí•œ DB ì¡°íšŒ)
        function itemNewItemsList(page = 1) {
            showLoading();
            
            // ItemRestControllerë¥¼ í†µí•´ DBì—ì„œ ì‹ ê·œë¬¼ê±´ ì¡°íšŒ
            fetch('/items/db/new-items?page=' + page + '&size=' + ITEM_PAGE_SIZE)
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                    const items = Array.isArray(data.items) ? data.items : (data.items || []);
                        const totalCount = data.totalCount || 0;
                    renderItemListTable(page, items, totalCount, 'DB ì‹ ë¬¼ê±´ ì¡°íšŒ (14ì¼ ì´ë‚´)', ITEM_PAGE_SIZE, 'itemNewItemsList');
                    } else {
                        document.getElementById('contentArea').innerHTML = 
                            '<h2>DB ì‹ ë¬¼ê±´ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>DB ì‹ ë¬¼ê±´ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // Item ê°ê°€ 50% ì´ìƒ ì¡°íšŒ (ItemRestControllerë¥¼ í†µí•œ DB ì¡°íšŒ)
        function itemDiscountItemsList(page = 1) {
            showLoading();
            
            // ItemRestControllerë¥¼ í†µí•´ DBì—ì„œ ê°ê°€50% ë¬¼ê±´ ì¡°íšŒ
            fetch('/items/db/discount-items?page=' + page + '&size=' + ITEM_PAGE_SIZE)
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                    const items = Array.isArray(data.items) ? data.items : (data.items || []);
                        const totalCount = data.totalCount || 0;
                    renderItemListTable(page, items, totalCount, 'DB ê°ê°€ 50% ì´ìƒ ì¡°íšŒ', ITEM_PAGE_SIZE, 'itemDiscountItemsList');
                    } else {
                        document.getElementById('contentArea').innerHTML = 
                            '<h2>DB ê°ê°€ 50% ì´ìƒ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>DB ê°ê°€ 50% ì´ìƒ ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // Item ìš©ë„ë³„ í†µí•© ì¡°íšŒ (ItemRestControllerë¥¼ í†µí•œ DB ì¡°íšŒ)
        function itemUsageItemsList(page = 1) {
            showLoading();
            
            // ItemRestControllerë¥¼ í†µí•´ DBì—ì„œ ì„œìš¸íŠ¹ë³„ì‹œ ì „ì²´ ë¬¼ê±´ ì¡°íšŒ
            fetch('/items/db/usage-items?page=' + page + '&size=' + ITEM_PAGE_SIZE)
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                    const items = Array.isArray(data.items) ? data.items : (data.items || []);
                        const totalCount = data.totalCount || 0;
                    renderItemListTable(page, items, totalCount, 'DB ìš©ë„ë³„ í†µí•© ì¡°íšŒ (ì„œìš¸íŠ¹ë³„ì‹œ)', ITEM_PAGE_SIZE, 'itemUsageItemsList');
                    } else {
                        document.getElementById('contentArea').innerHTML = 
                            '<h2>DB ìš©ë„ë³„ í†µí•© ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>DB ìš©ë„ë³„ í†µí•© ì¡°íšŒ</h2><p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // Item ëª©ë¡ í…Œì´ë¸” ë Œë”ë§ (ê³µí†µ í•¨ìˆ˜) - Unionê³¼ ë™ì¼í•œ êµ¬ì¡°
        function renderItemListTable(page, pageItems, totalCount, title, pageSize, functionName) {
            const totalPages = Math.ceil(totalCount / pageSize);
            
            let html = '<h2>' + title + '</h2>';
            html += '<p style="font-size: 16px; font-weight: bold; color: #004098; margin-bottom: 10px;">';
            html += 'ğŸ“Š ì´ ' + totalCount.toLocaleString() + 'ê±´ (í˜ì´ì§€ë‹¹ ' + pageSize + 'ê°œ) - DBì— ì €ì¥ëœ ë°ì´í„°';
            html += '</p>';
            
            if (pageItems && pageItems.length > 0) {
                html += '<div style="overflow-x: auto;">';
                html += '<table><thead><tr>';
                html += '<th>ìˆœë²ˆ</th><th>ë¬¼ê±´ë²ˆí˜¸</th><th>ì…ì°°ë²ˆí˜¸</th><th>ê¸°ê´€ëª…</th><th>ì§‘í–‰ê¸°ê´€ë²ˆí˜¸</th>';
                html += '<th>ì†Œì¬ì§€</th><th>ì§€ë²ˆì£¼ì†Œ</th><th>ë„ë¡œëª…</th><th>ê±´ë¬¼ë²ˆí˜¸</th>';
                html += '<th>ë¬¼ê±´ëª…</th><th>ìì‚°êµ¬ë¶„</th>';
                html += '<th>ìµœì €ì…ì°°ê°€</th><th>ê°ì •í‰ê°€ì•¡</th>';
                html += '<th>ì…ì°°ì‹œì‘</th><th>ì…ì°°ì¢…ë£Œ</th><th>ì…ì°°íšŒì°¨</th><th>ì…ì°°íšŸìˆ˜</th>';
                html += '<th>ì²˜ë¶„ë°©ì‹</th><th>ì…ì°°ë°©ì‹</th><th>ìˆ˜ìˆ˜ë£Œìœ¨</th>';
                html += '<th>ìƒíƒœ</th><th>ì¡°íšŒìˆ˜</th>';
                html += '</tr></thead><tbody>';
                
                pageItems.forEach((item, index) => {
                    html += '<tr>';
                    const displayRnum = (page - 1) * pageSize + index + 1;
                    html += '<td>' + displayRnum + '</td>';
                    html += '<td>' + (item.plnmNo || '-') + '</td>';
                    html += '<td>' + (item.pbctNo || '-') + '</td>';
                    html += '<td>' + (item.orgName || '-') + '</td>';
                    html += '<td>' + (item.orgBaseNo || '-') + '</td>';
                    html += '<td style="max-width:150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.address || '-') + '</td>';
                    html += '<td style="max-width:150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.nmrAddress || '-') + '</td>';
                    html += '<td style="max-width:150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.roadName || '-') + '</td>';
                    html += '<td>' + (item.bldNo || '-') + '</td>';
                    html += '<td style="max-width:200px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">' + (item.goodsDetail || '-') + '</td>';
                    html += '<td>' + (item.assetCategory || '-') + '</td>';
                    const minBidPrice = item.minBidPriceMax || item.minBidPriceMin;
                    html += '<td style="text-align:right;">' + (minBidPrice ? minBidPrice.toLocaleString() + 'ì›' : '-') + '</td>';
                    const appraisalAmount = item.appraisalAmountMax || item.appraisalAmountMin;
                    html += '<td style="text-align:right;">' + (appraisalAmount ? appraisalAmount.toLocaleString() + 'ì›' : '-') + '</td>';
                    html += '<td>' + formatDate2(item.bidStart) + '</td>';
                    html += '<td>' + formatDate2(item.bidEnd) + '</td>';
                    html += '<td>' + (item.bidRoundNo || '-') + '</td>';
                    html += '<td style="text-align:center; font-weight:bold; color:#e74c3c;">' + (item.bidCount || 1) + '</td>';
                    html += '<td>' + (item.disposalMethod || '-') + '</td>';
                    html += '<td>' + (item.bidMethod || '-') + '</td>';
                    html += '<td>' + (item.feeRate || '-') + '</td>';
                    html += '<td>' + (item.bidStatus || '-') + '</td>';
                    html += '<td>' + (item.viewCount || 0) + '</td>';
                    html += '</tr>';
                });
                
                html += '</tbody></table></div>';
                
                // í˜ì´ì§€ë„¤ì´ì…˜
                if (totalPages > 1) {
                    html += '<div style="margin-top: 20px; text-align: center;">';
                    html += '<div style="display: inline-block;">';
                    
                    if (page > 1) {
                        html += '<button onclick="' + functionName + '(' + (page - 1) + ')" style="padding: 8px 15px; margin: 0 5px;">ì´ì „</button>';
                    }
                    
                    const startPage = Math.max(1, page - 5);
                    const endPage = Math.min(totalPages, page + 5);
                    
                    if (startPage > 1) {
                        html += '<button onclick="' + functionName + '(1)" style="padding: 8px 15px; margin: 0 2px;">1</button>';
                        if (startPage > 2) html += '<span style="margin: 0 5px;">...</span>';
                    }
                    
                    for (let i = startPage; i <= endPage; i++) {
                        if (i === page) {
                            html += '<button onclick="' + functionName + '(' + i + ')" style="padding: 8px 15px; margin: 0 2px; background: #004098; color: white; font-weight: bold;">' + i + '</button>';
                        } else {
                            html += '<button onclick="' + functionName + '(' + i + ')" style="padding: 8px 15px; margin: 0 2px;">' + i + '</button>';
                        }
                    }
                    
                    if (endPage < totalPages) {
                        if (endPage < totalPages - 1) html += '<span style="margin: 0 5px;">...</span>';
                        html += '<button onclick="' + functionName + '(' + totalPages + ')" style="padding: 8px 15px; margin: 0 2px;">' + totalPages + '</button>';
                    }
                    
                    if (page < totalPages) {
                        html += '<button onclick="' + functionName + '(' + (page + 1) + ')" style="padding: 8px 15px; margin: 0 5px;">ë‹¤ìŒ</button>';
                    }
                    
                    html += '</div>';
                    html += '<p style="margin-top: 10px; color: #666; font-size: 14px; font-weight: bold;">';
                    html += 'ğŸ“„ í˜„ì¬ í˜ì´ì§€: ' + page + ' / ì „ì²´ í˜ì´ì§€: ' + totalPages + ' (ì´ ' + totalCount.toLocaleString() + 'ê±´)';
                    html += '</p>';
                    html += '</div>';
                } else {
                    // í˜ì´ì§€ê°€ 1ê°œì¼ ë•Œë„ ì´ ê±´ìˆ˜ í‘œì‹œ
                    html += '<p style="margin-top: 10px; color: #666; font-size: 14px; font-weight: bold;">';
                    html += 'ğŸ“„ ì „ì²´ í˜ì´ì§€: 1 (ì´ ' + totalCount.toLocaleString() + 'ê±´)';
                    html += '</p>';
                }
            } else {
                html += '<p style="color: #999; font-size: 14px;">ë°ì´í„° ì—†ìŒ (ì´ 0ê±´)</p>';
            }
            
            document.getElementById('contentArea').innerHTML = html;
        }
        
        // Item í˜ì´ì§€ ì €ì¥ í•¨ìˆ˜
        function saveItemPage(functionName, page) {
            let endpoint = '';
            if (functionName === 'itemNewItemsList') {
                endpoint = '/items/api/new-items/save';
            } else if (functionName === 'itemDiscountItemsList') {
                endpoint = '/items/api/discount-items/save';
            } else if (functionName === 'itemUsageItemsList') {
                endpoint = '/items/api/usage-items/save';
            } else {
                alert('ì•Œ ìˆ˜ ì—†ëŠ” í•¨ìˆ˜ëª…ì…ë‹ˆë‹¤.');
                return;
            }
            
            if (!confirm('í˜„ì¬ í˜ì´ì§€(' + page + 'í˜ì´ì§€)ì˜ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            fetch(endpoint + '?page=' + page + '&sido=ì„œìš¸íŠ¹ë³„ì‹œ', {
                method: 'POST'
            })
                .then(r => r.text())
                .then(data => {
                    alert(data);
                    // ì €ì¥ í›„ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    if (functionName === 'itemNewItemsList') {
                        itemNewItemsList(page);
                    } else if (functionName === 'itemDiscountItemsList') {
                        itemDiscountItemsList(page);
                    } else if (functionName === 'itemUsageItemsList') {
                        itemUsageItemsList(page);
                    }
                })
                .catch(error => {
                    alert('ì €ì¥ ì‹¤íŒ¨: ' + error.message);
                });
        }
        
        // DB ì‚­ì œ - ì‹ ë¬¼ê±´
        // ì‹ ë¬¼ê±´ DB ì‚­ì œ (ItemRestControllerë¥¼ í†µí•œ ì²˜ë¦¬)
        function deleteNewItemsFromDb() {
            if (!confirm('ì‹ ë¬¼ê±´ ë°ì´í„°ë¥¼ DBì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nItemRestControllerë¥¼ í†µí•´ 14ì¼ ì´ë‚´ ë°ì´í„°ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
            
            let html = '<h2>ì‹ ë¬¼ê±´ DB ì‚­ì œ</h2>';
            html += '<div id="deleteNewItemsResultArea" style="margin-top:20px;">';
            html += '<p style="color:#e74c3c; font-weight:bold;">ğŸ—‘ï¸ ì‹ ë¬¼ê±´ ì‚­ì œ ì¤‘...</p>';
            html += '<p>ItemRestControllerë¥¼ í†µí•´ ì‹ ë¬¼ê±´ ë°ì´í„°(14ì¼ ì´ë‚´)ë¥¼ DBì—ì„œ ì‚­ì œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>';
            html += '</div>';
            document.getElementById('contentArea').innerHTML = html;
            
            // ItemRestControllerë¥¼ í†µí•œ ì‚­ì œ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
            fetch('/items/db/delete-new-items', { method: 'DELETE' })
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                    document.getElementById('deleteNewItemsResultArea').innerHTML = 
                        '<p style="color: green; font-weight:bold;">âœ… ì‹ ë¬¼ê±´ ì‚­ì œ ì™„ë£Œ!</p>' +
                            '<p style="color: green;">ì‚­ì œëœ ê°œìˆ˜: ' + (data.affectedRows || 0) + 'ê±´</p>' +
                            '<pre style="background:#f5f5f5; padding:10px; border-radius:5px; overflow:auto;">' + JSON.stringify(data, null, 2) + '</pre>';
                    } else {
                        document.getElementById('deleteNewItemsResultArea').innerHTML = 
                            '<p style="color: red; font-weight:bold;">âŒ ì‹ ë¬¼ê±´ ì‚­ì œ ì‹¤íŒ¨</p>' +
                            '<p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('deleteNewItemsResultArea').innerHTML = 
                        '<p style="color: red; font-weight:bold;">âŒ ì‹ ë¬¼ê±´ ì‚­ì œ ì‹¤íŒ¨</p>' +
                        '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // ê°ê°€50%ë¬¼ê±´ DB ì‚­ì œ (ItemRestControllerë¥¼ í†µí•œ ì²˜ë¦¬)
        function deleteDiscountItemsFromDb() {
            if (!confirm('ê°ê°€50%ë¬¼ê±´ ë°ì´í„°ë¥¼ DBì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nItemRestControllerë¥¼ í†µí•´ ê°ê°€ 50% ì´ìƒ ë¬¼ê±´ì„ ì‚­ì œí•©ë‹ˆë‹¤.\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
            
            let html = '<h2>ê°ê°€50%ë¬¼ê±´ DB ì‚­ì œ</h2>';
            html += '<div id="deleteDiscountItemsResultArea" style="margin-top:20px;">';
            html += '<p style="color:#e74c3c; font-weight:bold;">ğŸ—‘ï¸ ê°ê°€50%ë¬¼ê±´ ì‚­ì œ ì¤‘...</p>';
            html += '<p>ItemRestControllerë¥¼ í†µí•´ ê°ê°€50%ë¬¼ê±´ ë°ì´í„°ë¥¼ DBì—ì„œ ì‚­ì œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>';
            html += '</div>';
            document.getElementById('contentArea').innerHTML = html;
            
            // ItemRestControllerë¥¼ í†µí•œ ì‚­ì œ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
            fetch('/items/db/delete-discount-items', { method: 'DELETE' })
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                    document.getElementById('deleteDiscountItemsResultArea').innerHTML = 
                        '<p style="color: green; font-weight:bold;">âœ… ê°ê°€50%ë¬¼ê±´ ì‚­ì œ ì™„ë£Œ!</p>' +
                            '<p style="color: green;">ì‚­ì œëœ ê°œìˆ˜: ' + (data.affectedRows || 0) + 'ê±´</p>' +
                            '<pre style="background:#f5f5f5; padding:10px; border-radius:5px; overflow:auto;">' + JSON.stringify(data, null, 2) + '</pre>';
                    } else {
                        document.getElementById('deleteDiscountItemsResultArea').innerHTML = 
                            '<p style="color: red; font-weight:bold;">âŒ ê°ê°€50%ë¬¼ê±´ ì‚­ì œ ì‹¤íŒ¨</p>' +
                            '<p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('deleteDiscountItemsResultArea').innerHTML = 
                        '<p style="color: red; font-weight:bold;">âŒ ê°ê°€50%ë¬¼ê±´ ì‚­ì œ ì‹¤íŒ¨</p>' +
                        '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // ìš©ë„ë³„í†µí•©ë¬¼ê±´ DB ì‚­ì œ (ItemRestControllerë¥¼ í†µí•œ ì²˜ë¦¬)
        function deleteUsageItemsFromDb() {
            if (!confirm('ìš©ë„ë³„í†µí•©ë¬¼ê±´ ë°ì´í„°ë¥¼ DBì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nItemRestControllerë¥¼ í†µí•´ ì„œìš¸íŠ¹ë³„ì‹œ ì „ì²´ ë¬¼ê±´ì„ ì‚­ì œí•©ë‹ˆë‹¤.\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
            
            let html = '<h2>ìš©ë„ë³„í†µí•©ë¬¼ê±´ DB ì‚­ì œ</h2>';
            html += '<div id="deleteUsageItemsResultArea" style="margin-top:20px;">';
            html += '<p style="color:#e74c3c; font-weight:bold;">ğŸ—‘ï¸ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì‚­ì œ ì¤‘...</p>';
            html += '<p>ItemRestControllerë¥¼ í†µí•´ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ë°ì´í„°(ì„œìš¸íŠ¹ë³„ì‹œ ì „ì²´)ë¥¼ DBì—ì„œ ì‚­ì œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>';
            html += '</div>';
            document.getElementById('contentArea').innerHTML = html;
            
            // ItemRestControllerë¥¼ í†µí•œ ì‚­ì œ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
            fetch('/items/db/delete-usage-items', { method: 'DELETE' })
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                    document.getElementById('deleteUsageItemsResultArea').innerHTML = 
                        '<p style="color: green; font-weight:bold;">âœ… ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì‚­ì œ ì™„ë£Œ!</p>' +
                            '<p style="color: green;">ì‚­ì œëœ ê°œìˆ˜: ' + (data.affectedRows || 0) + 'ê±´</p>' +
                            '<pre style="background:#f5f5f5; padding:10px; border-radius:5px; overflow:auto;">' + JSON.stringify(data, null, 2) + '</pre>';
                    } else {
                        document.getElementById('deleteUsageItemsResultArea').innerHTML = 
                            '<p style="color: red; font-weight:bold;">âŒ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì‚­ì œ ì‹¤íŒ¨</p>' +
                            '<p style="color: red;">ì˜¤ë¥˜: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';
                    }
                })
                .catch(error => {
                    document.getElementById('deleteUsageItemsResultArea').innerHTML = 
                        '<p style="color: red; font-weight:bold;">âŒ ìš©ë„ë³„í†µí•©ë¬¼ê±´ ì‚­ì œ ì‹¤íŒ¨</p>' +
                        '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        // íšŒì› ëª©ë¡
        function memberList() {
            showLoading();
            
            // ì„œë²„ì—ì„œ ì „ì²´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            fetch(API_BASE + '/members/all')
                .then(r => r.json())
                .then(data => {
                    const members = Array.isArray(data) ? data : [];
                    renderMemberList(members);
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>íšŒì› ëª©ë¡</h2><p>ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        function renderMemberList(members) {
                    let html = '<h2>íšŒì› ëª©ë¡</h2>';
            html += '<p>ì´ ' + members.length + 'ëª…</p>';
                    
            if (members && members.length > 0) {
                        html += '<table><thead><tr>';
                        html += '<th>ID</th><th>ì´ë¦„</th><th>ì´ë©”ì¼</th><th>ê°€ì…ì¼</th><th>ê´€ë¦¬</th>';
                        html += '</tr></thead><tbody>';
                        
                members.forEach(member => {
                            html += '<tr>';
                            html += '<td>' + member.id + '</td>';
                            html += '<td>' + member.name + '</td>';
                            html += '<td>' + member.mail + '</td>';
                            html += '<td>' + formatDate2(member.joinDate) + '</td>';
                            html += '<td class="member-actions">';
                            html += '<button onclick="editMember(\'' + member.id + '\')">ìˆ˜ì •</button>';
                            html += '<button onclick="deleteMember(\'' + member.id + '\')">ì‚­ì œ</button>';
                            html += '</td>';
                            html += '</tr>';
                        });
                        
                        html += '</tbody></table>';
                    } else {
                        html += '<p>íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    }
                    
                    document.getElementById('contentArea').innerHTML = html;
        }
        
        function deleteMember(memberId) {
            if (!confirm('íšŒì› ' + memberId + 'ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            fetch(API_BASE + '/members/' + memberId, {
                method: 'DELETE'
            })
            .then(r => r.json())
            .then(data => {
                alert(data.message || 'ì‚­ì œ ì™„ë£Œ');
                memberList(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            })
            .catch(err => {
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜: ' + err.message);
            });
        }

        function editMember(memberId) {
            const newName = prompt('ìƒˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ë¹„ì›Œë‘ë©´ ë³€ê²½ ì•ˆ í•¨):');
            const newEmail = prompt('ìƒˆ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš” (ë¹„ì›Œë‘ë©´ ë³€ê²½ ì•ˆ í•¨):');
            const newPhone = prompt('ìƒˆ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ë¹„ì›Œë‘ë©´ ë³€ê²½ ì•ˆ í•¨):');

            const payload = { memberId: memberId };
            if (newName && newName.trim() !== '') payload.name = newName.trim();
            if (newEmail && newEmail.trim() !== '') payload.mail = newEmail.trim();
            if (newPhone && newPhone.trim() !== '') payload.phone = newPhone.trim();

            if (Object.keys(payload).length === 1) {
                alert('ë³€ê²½í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            fetch(API_BASE + '/members/update', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
            .then(r => r.json())
            .then(data => {
                alert(data.message || 'ìˆ˜ì • ì™„ë£Œ');
                memberList(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            })
            .catch(err => {
                alert('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜: ' + err.message);
            });
        }
        
        // 8. ê²Œì‹œê¸€ ëª©ë¡ (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ í˜ì´ì§€ë„¤ì´ì…˜)
        function boardList() {
            showLoading();
            
            // ì„œë²„ì—ì„œ ì „ì²´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            fetch(API_BASE + '/boards/all')
                .then(r => r.json())
                .then(data => {
                    const boards = Array.isArray(data) ? data : [];
                    renderBoardList(boards);
                })
                .catch(error => {
                    document.getElementById('contentArea').innerHTML = 
                        '<h2>ê²Œì‹œê¸€ ëª©ë¡</h2><p>ì˜¤ë¥˜: ' + error.message + '</p>';
                });
        }
        
        function renderBoardList(boards) {
                    let html = '<h2>ê²Œì‹œê¸€ ëª©ë¡</h2>';
            html += '<p>ì´ ' + boards.length + 'ê°œ</p>';
                    
            if (boards && boards.length > 0) {
                        html += '<table><thead><tr>';
                        html += '<th>ë²ˆí˜¸</th><th>ì œëª©</th><th>ì‘ì„±ì</th><th>ì‘ì„±ì¼</th><th>ê´€ë¦¬</th>';
                        html += '</tr></thead><tbody>';
                        
                boards.forEach(board => {
                            html += '<tr>';
                            html += '<td>' + board.no + '</td>';
                            html += '<td>' + board.title + '</td>';
                            html += '<td>' + board.id + '</td>';
                            html += '<td>' + formatDate2(board.regDate) + '</td>';
                            html += '<td>';
                            html += '<button onclick="deleteBoard(' + board.no + ')">ì‚­ì œ</button>';
                            html += '</td>';
                            html += '</tr>';
                        });
                        
                        html += '</tbody></table>';
                    } else {
                        html += '<p>ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    }
                    
                    document.getElementById('contentArea').innerHTML = html;
        }

        function deleteBoard(boardNo) {
            if (!confirm('ê²Œì‹œê¸€ ë²ˆí˜¸ ' + boardNo + 'ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            fetch(API_BASE + '/boards/' + boardNo, {
                method: 'DELETE'
            })
            .then(r => r.json())
            .then(data => {
                alert(data.message || 'ì‚­ì œ ì™„ë£Œ');
                boardList(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            })
            .catch(err => {
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜: ' + err.message);
            });
        }
        
        // ìœ í‹¸ë¦¬í‹°
        function showLoading() {
            document.getElementById('contentArea').innerHTML = 
                '<div class="loading">ë¡œë”© ì¤‘...</div>';
        }
        
        function formatDate2(dateStr) {
            if (!dateStr) return '-';
            return new Date(dateStr).toLocaleString('ko-KR');
        }
    </script>

<!-- =================== í‘¸í„° =================== -->
<div th:replace="~{layout/footer :: footer}"></div>

</body>
</html>
