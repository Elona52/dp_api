<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²½ë§¤ë¬¼ê±´ìƒì„¸ê²€ìƒ‰</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
    
    <!-- Court Auction CSS -->
    <link rel="stylesheet" th:href="@{/css/auction.css}">
    <link rel="stylesheet" th:href="@{/css/kamco.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    
    <style>
        :root {
            --court-blue: #004098;
            --court-navy: #002855;
            --court-green: #52b788;
            --court-red: #d32f2f;
            --border-gray: #ddd;
            --bg-light: #f5f5f5;
            --text-dark: #333;
            --text-gray: #777;
        }
        
        * {
            box-sizing: border-box !important;
        }
        
        html, body {
            font-family: 'Nanum Gothic', 'Malgun Gothic', sans-serif !important;
            background: #f5f5f5 !important;
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            max-width: 100vw !important;
            overflow-x: hidden !important;
        }
        
        /* ========== í—¤ë” ========== */
        /* í—¤ë” ìŠ¤íƒ€ì¼ì€ auction.cssì—ì„œ ê´€ë¦¬í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ìµœì†Œí•œì˜ ì¡°ì •ë§Œ */
        .court-header {
            width: 100% !important;
            max-width: 100% !important;
        }
        
        /* ========== ë©”ì¸ ì»¨í…Œì´ë„ˆ ========== */
        main {
            width: 100% !important;
            max-width: 100% !important;
        }
        
        .list-container {
            margin: 0 auto !important;
            padding: 20px 40px !important;
            display: flex !important;
            gap: 30px !important;
            width: 100% !important;
            max-width: 1400px !important;
            align-items: flex-start !important;
        }
        
        .left-nav {
            flex-shrink: 0 !important;
        }
        
        .main-content {
            flex: 1 !important;
            min-width: 0 !important;
        }
        
        /* ========== í‘¸í„° ========== */
        .court-footer {
            background: #f8f9fa !important;
            padding: 30px 40px !important;
            border-top: 1px solid var(--border-gray) !important;
            margin-top: 60px !important;
            width: 100% !important;
            max-width: 100% !important;
        }
        
        .footer-content {
            margin: 0 !important;
            padding: 0 !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            width: 100% !important;
        }
        
        .footer-info {
            font-size: 13px;
            color: var(--text-gray);
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
        }
        
        .footer-links a {
            color: var(--text-gray);
            text-decoration: none;
            font-size: 13px;
        }
        
        /* ì™¼ìª½ ë„¤ë¹„ê²Œì´ì…˜ */
        .left-nav {
            background: #fff;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 0;
            height: fit-content;
        }
        
        .nav-header {
            background: var(--court-blue);
            color: #fff;
            padding: 15px 20px;
            font-size: 16px;
            font-weight: 700;
            border-radius: 8px 8px 0 0;
        }
        
        .nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .nav-list li {
            border-bottom: 1px solid #f0f0f0;
        }
        
        .nav-list li:last-child {
            border-bottom: none;
        }
        
        .nav-list li a {
            display: block;
            padding: 14px 20px;
            color: var(--text-dark);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .nav-list li a:hover {
            background: #f8f9fa;
            color: var(--court-blue);
            padding-left: 25px;
        }
        
        .nav-list li a.active {
            background: var(--court-blue);
            color: #fff;
            font-weight: 700;
        }
        
        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-content {
            background: #fff !important;
            border: 1px solid var(--border-gray) !important;
            border-radius: 8px !important;
            width: 100% !important;
            max-width: 100% !important;
            min-width: 0 !important;
        }
        
        .breadcrumb {
            padding: 15px 25px;
            border-bottom: 1px solid var(--border-gray);
            font-size: 13px;
            color: var(--text-gray);
        }
        
        .breadcrumb a {
            color: var(--text-gray);
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            color: var(--court-blue);
        }
        
        .search-summary {
            padding: 20px 25px;
            background: #f8f9fa;
            border-bottom: 1px solid var(--border-gray);
        }
        
        .search-summary-title {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
        }
        
        .search-summary-text {
            font-size: 14px;
            color: var(--text-gray);
        }
        
        .search-summary-text strong {
            color: var(--court-blue);
            font-weight: 700;
        }
        
        .note {
            padding: 12px 25px;
            background: #fffbf0;
            border-bottom: 1px solid #ffe082;
            font-size: 13px;
            color: #795548;
        }
        
        /* í…Œì´ë¸” */
        .table-container {
            padding: 25px !important;
            width: 100% !important;
            max-width: 100% !important;
            border-radius: 0 !important;
        }
        
        .auction-table {
            width: 100% !important;
            max-width: none !important;
            min-width: 100% !important;
            border-collapse: collapse !important;
            font-size: 13px !important;
            table-layout: fixed !important;
            border-radius: 0 !important;
        }
        
        .auction-table th,
        .auction-table td {
            border-radius: 0 !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            max-height: 120px !important;
        }
        
        .auction-table td {
            vertical-align: top !important;
        }
        
        .location-details .address {
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .building-info {
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            line-height: 1.4;
        }
        
        .remarks {
            max-height: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
        }
        
        .auction-table thead {
            background: #f8f9fa;
            border-top: 2px solid var(--court-blue);
            border-bottom: 1px solid var(--border-gray);
        }
        
        .auction-table thead th {
            padding: 15px 10px;
            text-align: center;
            font-weight: 700;
            color: var(--text-dark);
            font-size: 14px;
        }
        
        .auction-table tbody tr {
            height: 140px;
            max-height: 140px;
        }
        
        .auction-table tbody td {
            padding: 15px 10px;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: top;
            height: 140px;
            max-height: 140px;
        }
        
        .auction-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .item-number {
            text-align: center;
            color: var(--text-gray);
            font-weight: 600;
        }
        
        .case-number {
            font-size: 12px;
            color: var(--text-gray);
        }
        
        .location-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .usage-badge {
            display: inline-block;
            padding: 4px 10px;
            background: var(--court-blue);
            color: #fff;
            border-radius: 0;
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .address {
            color: var(--text-dark);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 5px;
        }
        
        .address:hover {
            color: var(--court-blue);
            text-decoration: underline;
        }
        
        .building-info {
            font-size: 12px;
            color: var(--text-gray);
            padding: 8px;
            background: #f8f9fa;
            border-radius: 0;
            margin-bottom: 5px;
        }
        
        
        .remarks {
            font-size: 12px;
            color: #d32f2f;
            line-height: 1.6;
        }
        
        .price-info {
            text-align: right;
        }
        
        .price-label {
            font-size: 12px;
            color: var(--text-gray);
            margin-bottom: 5px;
        }
        
        .price-value {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 8px;
        }
        
        .price-value.min-price {
            font-size: 16px;
            color: var(--court-blue);
        }
        
        .price-percent {
            font-size: 12px;
            color: var(--court-green);
            font-weight: 600;
        }
        
        .dept-info {
            text-align: center;
        }
        
        .dept-name {
            font-size: 13px;
            color: var(--text-dark);
            margin-bottom: 5px;
        }
        
        .auction-date {
            font-size: 13px;
            color: var(--court-blue);
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .status-badge-table {
            display: inline-block;
            padding: 4px 10px;
            background: #fff3cd;
            color: #856404;
            border-radius: 0;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-badge-table.new {
            background: #d4edda;
            color: #155724;
        }
        
        .status-badge-table.failed {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* í˜ì´ì§€ë„¤ì´ì…˜ */
        .pagination-wrapper {
            padding: 30px 25px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }
        
        .pagination {
            display: flex;
            gap: 5px;
        }
        
        .pagination button,
        .pagination a {
            padding: 8px 12px;
            border: 1px solid var(--border-gray);
            background: #fff;
            color: var(--text-dark);
            cursor: pointer;
            border-radius: 4px;
            font-size: 13px;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .pagination button:hover,
        .pagination a:hover {
            background: #f0f0f0;
        }
        
        .pagination button.active,
        .pagination a.active {
            background: var(--court-blue);
            color: #fff;
            border-color: var(--court-blue);
            font-weight: 700;
        }
        
        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }
        
        .page-size-selector select {
            padding: 6px 10px;
            border: 1px solid var(--border-gray);
            border-radius: 4px;
        }
        
        /* ì•¡ì…˜ ë²„íŠ¼ */
        .action-buttons {
            padding: 20px 25px;
            border-top: 1px solid var(--border-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .action-buttons .left,
        .action-buttons .right {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 10px 20px;
            border: 1px solid var(--border-gray);
            background: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: var(--court-blue);
            color: #fff;
            border-color: var(--court-blue);
        }
        
        .action-btn.primary {
            background: var(--court-blue);
            color: #fff;
        }
        
        .action-btn.primary:hover {
            background: var(--court-navy);
        }
        
        /* ë¡œë”© ì¸ë””ì¼€ì´í„° */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        
        .loading-overlay.show {
            display: flex;
        }
        
        .loading-spinner {
            background: #fff;
            padding: 30px 50px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--court-blue);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 16px;
            color: var(--text-dark);
            font-weight: 600;
        }
    </style>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body style="margin: 0 !important; padding: 0 !important; width: 100% !important; max-width: 100vw !important; overflow-x: hidden !important; background: #f5f5f5 !important; font-family: 'Nanum Gothic', sans-serif !important;">

<!-- =================== ë¡œë”© ì¸ë””ì¼€ì´í„° =================== -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="loading-spinner">
        <div class="spinner"></div>
        <div class="loading-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>
</div>

<!-- =================== í—¤ë” =================== -->
<div th:replace="~{layout/header :: header}"></div>

<!-- =================== ë©”ì¸ ì»¨í…ì¸  =================== -->
<main class="list-container" style="margin: 0 auto !important; padding: 20px 40px !important; display: flex !important; gap: 30px !important; width: 100% !important; max-width: 1400px !important; align-items: flex-start !important;">
    
    <!-- ì™¼ìª½ ë„¤ë¹„ê²Œì´ì…˜ -->
    <aside class="left-nav" style="width: 220px !important; max-width: 220px !important; min-width: 220px !important; flex-shrink: 0 !important; background: #fff !important; border: 1px solid #ddd !important; border-radius: 0 !important;">
        <!-- ê²½ë§¤ê³µê³  í˜ì´ì§€ (ì‹ ê·œë¬¼ê±´ ë˜ëŠ” 50% ì²´ê° ë¬¼ê±´)ì¼ ë•Œ -->
        <th:block th:if="${category == 'ì‹ ê·œë¬¼ê±´' or category == '50% ì²´ê° ë¬¼ê±´'}">
            <div class="nav-header">â€¢ ê²½ë§¤ê³µê³ </div>
            <ul class="nav-list">
                <li><a th:href="@{/new-items}" 
                       th:class="${category == 'ì‹ ê·œë¬¼ê±´' ? 'active' : ''}">ì‹ ê·œë¬¼ê±´</a></li>
                <li><a th:href="@{/discount-50}"
                       th:class="${category == '50% ì²´ê° ë¬¼ê±´' ? 'active' : ''}">50% ì²´ê° ë¬¼ê±´</a></li>
            </ul>
        </th:block>
        
        <!-- ê²½ë§¤ë¬¼ê±´ í˜ì´ì§€ì¼ ë•Œ -->
        <th:block th:unless="${category == 'ì‹ ê·œë¬¼ê±´' or category == '50% ì²´ê° ë¬¼ê±´'}">
        <div class="nav-header">â€¢ ê²½ë§¤ë¬¼ê±´</div>
        <ul class="nav-list">
            <li><a th:href="@{/auctionList}" 
                   th:class="${category == null or category == 'all' ? 'active' : ''}">ë¬¼ê±´ìƒì„¸ê²€ìƒ‰ (ì „ì²´)</a></li>
            <li><a th:href="@{/auctionList(category='ì£¼ê±°ìš©ê±´ë¬¼')}"
                   th:class="${category != null and category.contains('ì£¼ê±°ìš©ê±´ë¬¼') ? 'active' : ''}">ì£¼ê±°ìš©ê±´ë¬¼</a></li>
            <li><a th:href="@{/auctionList(category='ìƒê°€ìš©ë°ì—…ë¬´ìš©ê±´ë¬¼')}"
                   th:class="${category != null and category.contains('ìƒê°€ìš©ë°ì—…ë¬´ìš©ê±´ë¬¼') ? 'active' : ''}">ìƒê°€ìš©ê±´ë¬¼</a></li>
            <li><a th:href="@{/auctionList(category='í† ì§€')}"
                   th:class="${category != null and category.contains('í† ì§€') ? 'active' : ''}">í† ì§€</a></li>
            <li><a th:href="@{/auctionList(category='ìë™ì°¨')}"
                   th:class="${category != null and category.contains('ìë™ì°¨') ? 'active' : ''}">ìë™ì°¨Â·ì¤‘ê¸°</a></li>
            <li><a th:href="@{/auctionList(category='ì‚°ì—…ìš©ë°ê¸°íƒ€íŠ¹ìˆ˜ìš©ê±´ë¬¼')}"
                   th:class="${category != null and category.contains('ì‚°ì—…ìš©ë°ê¸°íƒ€íŠ¹ìˆ˜ìš©ê±´ë¬¼') ? 'active' : ''}">ì‚°ì—…ìš©ê±´ë¬¼</a></li>
            <li><a th:href="@{/auctionList(category='ìš©ë„ë³µí•©ìš©ê±´ë¬¼')}"
                   th:class="${category != null and category.contains('ìš©ë„ë³µí•©ìš©ê±´ë¬¼') ? 'active' : ''}">ìš©ë„ë³µí•©ê±´ë¬¼</a></li>
            <li><a th:href="@{/auctionList(category='ê¸°ê³„ê¸°êµ¬')}"
                   th:class="${category != null and category.contains('ê¸°ê³„ê¸°êµ¬') ? 'active' : ''}">ê¸°ê³„ê¸°êµ¬</a></li>
            <li><a href="#" onclick="alert('ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤'); return false;">ì§€ë„ê²€ìƒ‰</a></li>
        </ul>
        </th:block>
    </aside>
    
    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <section class="main-content" 
             th:data-async-load="${asyncLoad != null ? asyncLoad : false}"
             th:data-category="${category != null ? category : 'all'}"
             style="background: #fff !important; border: 1px solid #ddd !important; border-radius: 0 !important; flex: 1 !important; min-width: 0 !important; overflow: hidden !important;">
        
        <!-- ë¸Œë ˆë“œí¬ëŸ¼ -->
        <div class="breadcrumb">
            <a href="/">â–² HOME</a> &gt; 
            <!-- ê²½ë§¤ê³µê³  í˜ì´ì§€ì¼ ë•Œ -->
            <th:block th:if="${category == 'ì‹ ê·œë¬¼ê±´' or category == '50% ì²´ê° ë¬¼ê±´'}">
                <a th:href="@{/new-items}">ê²½ë§¤ê³µê³ </a> &gt; 
                <span th:text="${category == 'ì‹ ê·œë¬¼ê±´' ? 'ì‹ ê·œë¬¼ê±´' : '50% ì²´ê° ë¬¼ê±´'}">ì‹ ê·œë¬¼ê±´</span>
            </th:block>
            <!-- ê²½ë§¤ë¬¼ê±´ í˜ì´ì§€ì¼ ë•Œ -->
            <th:block th:unless="${category == 'ì‹ ê·œë¬¼ê±´' or category == '50% ì²´ê° ë¬¼ê±´'}">
            <a th:href="@{/auctionList}">ê²½ë§¤ë¬¼ê±´</a> &gt; 
            <span>ë¬¼ê±´ìƒì„¸ê²€ìƒ‰</span>
            </th:block>
        </div>
        
        <!-- ê²€ìƒ‰ ì¡°ê±´ -->
        <div class="search-summary">
            <div class="search-summary-title">ê²€ìƒ‰ì¡°ê±´</div>
            <div class="search-summary-text">
                <th:block th:if="${category != null and category != 'all'}">
                    ì¹´í…Œê³ ë¦¬ <strong th:text="${category}">ë¶€ë™ì‚° / ì•„íŒŒíŠ¸</strong> | 
                </th:block>
                <th:block th:unless="${category != null and category != 'all'}">
                    ì¹´í…Œê³ ë¦¬ <strong>ì „ì²´</strong> | 
                </th:block>
                ì´ ë¬¼ê±´ìˆ˜ <strong th:text="${totalCount} + 'ê±´'">100ê±´</strong>
            </div>
        </div>
        
        <!-- ì•ˆë‚´ ë¬¸êµ¬ -->
        <div class="note">
            â€¢ ì†Œì¬ì§€ ë° ë‚´ì—­ì„ í´ë¦­í•˜ë©´ ë¬¼ê±´ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.
        </div>
        
        <!-- í…Œì´ë¸” -->
        <div class="table-container" style="padding: 25px !important; width: 100% !important; max-width: none !important; overflow-x: auto !important;">
            <table class="auction-table" style="width: 100% !important; max-width: none !important; min-width: 100% !important; border-collapse: collapse !important; font-size: 13px !important; table-layout: fixed !important;">
                <thead>
                    <tr>
                        <th style="width: 3%;">
                            <input type="checkbox" id="selectAll">
                        </th>
                        <th style="width: 5%;">ë¬¼ê±´<br>ë²ˆí˜¸ â–²</th>
                        <th style="width: 40%;">ì†Œì¬ì§€ ë° ë‚´ì—­ â–²</th>
                        <th style="width: 15%;">ë¹„ê³ </th>
                        <th style="width: 20%;">ê°ì •í‰ê°€ì•¡ â–²<br>ìµœì €ë§¤ê°ê°€ê²©</th>
                        <th style="width: 17%;">ë‹´ë‹¹ê³„<br>ë§¤ê°ê¸°ì¼ â–²</th>
                    </tr>
                </thead>
                <tbody>
                    <th:block th:if="${atList != null and !atList.isEmpty()}">
                        <tr th:each="item, stat : ${atList}">
                            <!-- ì²´í¬ë°•ìŠ¤ -->
                            <td style="text-align: center;">
                                <input type="checkbox" th:value="${item.cltrNo}">
                            </td>
                            
                            <!-- ë¬¼ê±´ë²ˆí˜¸ -->
                            <td class="item-number" th:text="${stat.count}">1</td>
                            
                            <!-- ì†Œì¬ì§€ ë° ë‚´ì—­ -->
                            <td>
                                <div class="location-details">
                                    <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 5px;">
                                        <span class="usage-badge">ì˜¨ë¹„ë“œ</span>
                                        <span class="case-number" th:text="'ë¬¼ê±´ë²ˆí˜¸: ' + ${item.cltrNo}" style="font-size: 11px; color: #999;">ë¬¼ê±´ë²ˆí˜¸: 1234567</span>
                                    </div>
                                    <a class="address" 
                                       th:href="@{/api-item-detail(cltrNo=${item.cltrNo})}"
                                       th:text="${item.name}"
                                       style="cursor: pointer; text-decoration: none; color: inherit;">
                                        ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-45
                                    </a>
                                    <div class="building-info" th:if="${item.content != null}" th:text="${item.content}">
                                        [ì§‘í•©ê±´ë¬¼ ì² ê·¼ì½˜í¬ë¦¬íŠ¸ì¡° 84.30ã¡ ì§€í•˜1ì¸µ 31.49ã¡]
                                    </div>
                                </div>
                            </td>
                            
                            <!-- ë¹„ê³  -->
                            <td class="remarks">
                                <div th:if="${item.count > 0}">
                                    â€¢ ì…ì°°ì°¸ê°€ì <span th:text="${item.count}">0</span>ëª…
                                </div>
                                <div>â€¢ ê³µê³µê²½ë§¤</div>
                            </td>
                            
                            <!-- ê°ì •í‰ê°€ì•¡ -->
                            <td class="price-info">
                                <div class="price-label">ê°ì •í‰ê°€ì•¡</div>
                                <div class="price-value" th:text="${item.endPrice > 0 ? #numbers.formatInteger(item.endPrice, 3, 'COMMA') : '-'}">622,000,000</div>
                                <div class="price-label">ìµœì €ë§¤ê°ê°€ê²©</div>
                                <div class="price-value min-price">
                                    <span th:text="${item.startPrice > 0 ? #numbers.formatInteger(item.startPrice, 3, 'COMMA') : '-'}">398,080,000</span>
                                    <span th:if="${item.endPrice > 0 and item.startPrice > 0}" 
                                          class="price-percent" 
                                          th:text="'(' + ${#numbers.formatInteger((item.startPrice * 100) / item.endPrice, 0)} + '%)'">
                                        (64%)
                                    </span>
                                </div>
                            </td>
                            
                            <!-- ë‹´ë‹¹ê³„ ë§¤ê°ê¸°ì¼ -->
                            <td class="dept-info">
                                <div class="dept-name">ìº ì½”</div>
                                <div class="auction-date" th:if="${item.endDate != null}">
                                    <span th:with="year=${#temporals.year(item.endDate)}, currentYear=${T(java.time.LocalDateTime).now().year}"
                                          th:if="${year >= 2020 and year <= currentYear}"
                                          th:text="${#temporals.format(item.endDate, 'yyyy.MM.dd')}">2025.11.20</span>
                                    <span th:unless="${year >= 2020 and year <= currentYear}">-</span>
                                </div>
                                <div class="auction-date" th:unless="${item.endDate != null}">-</div>
                                <div>
                                    <!-- ì‹ ê·œë¬¼ê±´ í˜ì´ì§€ì¼ ë•Œë§Œ "ì‹ ê±´" ë°°ì§€ í‘œì‹œ -->
                                    <span th:if="${category == 'ì‹ ê·œë¬¼ê±´' and item.count == 0}" class="status-badge-table new">ì‹ ê±´</span>
                                    <!-- ì „ì²´ ê²½ë§¤ë¬¼ê±´ í˜ì´ì§€ì—ì„œëŠ” ìœ ì°° íšŸìˆ˜ë§Œ í‘œì‹œ -->
                                    <span th:if="${category != 'ì‹ ê·œë¬¼ê±´' and item.count == 0}" class="status-badge-table" style="background: #d4edda; color: #155724;">ìœ ì°° 0íšŒ</span>
                                    <span th:if="${item.count > 0 and item.count <= 2}" class="status-badge-table failed" th:text="|ìœ ì°° ${item.count}íšŒ|">ìœ ì°° 2íšŒ</span>
                                    <span th:if="${item.count > 2}" class="status-badge-table" th:text="|ìœ ì°° ${item.count}íšŒ|">ìœ ì°° 3íšŒ</span>
                                </div>
                            </td>
                        </tr>
                    </th:block>
                    <tr th:if="${atList == null or atList.isEmpty()}">
                        <td colspan="6" style="text-align: center; padding: 60px; color: var(--text-gray);">
                            ì¡°íšŒëœ ë¬¼ê±´ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div class="pagination-wrapper">
            <div class="pagination" id="paginationContainer">
                <!-- ì´ˆê¸° í˜ì´ì§€ë„¤ì´ì…˜ (ë¹„ë™ê¸° ë¡œë”© í›„ ì—…ë°ì´íŠ¸ë¨) -->
                <span style="color: var(--text-gray);">í˜ì´ì§€ ë¡œë”© ì¤‘...</span>
            </div>
            
            <div class="page-size-selector">
                <label for="pageSize">í˜ì´ì§€ë‹¹</label>
                <select id="pageSize" onchange="changePageSize(this.value)">
                    <option value="10">10</option>
                    <option value="20" selected>20</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
        </div>
        
        <!-- ì•¡ì…˜ ë²„íŠ¼ -->
        <div class="action-buttons">
            <div class="left">
                <button class="action-btn" onclick="compareItems()">
                    <i class="fas fa-balance-scale"></i> ë¬¼ê±´ë¹„êµ
                </button>
                <button class="action-btn primary" id="addFavoritesBtn" onclick="addToFavoritesMultiple(); return false;">
                    <i class="fas fa-star"></i> ê´€ì‹¬ë¬¼ê±´ë“±ë¡
                </button>
            </div>
            <div class="right">
                <button class="action-btn" onclick="history.back()">
                    <i class="fas fa-arrow-left"></i> ì´ì „
                </button>
            </div>
        </div>
        
    </section>
    
</main>

<!-- =================== í‘¸í„° =================== -->
<div th:replace="~{layout/footer :: footer}"></div>

<!-- JavaScript -->
<script>
// ë¹„ë™ê¸° ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
function loadItemsAsync() {
    console.log('ğŸ”µ ========== loadItemsAsync í•¨ìˆ˜ í˜¸ì¶œë¨! ==========');
    
    const loadingOverlay = document.getElementById('loadingOverlay');
    console.log('ğŸ“‹ loadingOverlay ì°¾ìŒ:', loadingOverlay !== null);
    if (loadingOverlay) {
        loadingOverlay.classList.add('show');
        console.log('âœ… ë¡œë”© ì˜¤ë²„ë ˆì´ í‘œì‹œ');
    } else {
        console.warn('âš ï¸ loadingOverlayë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
    }
    
    // tbody í™•ì¸
    const tbody = document.querySelector('.auction-table tbody');
    console.log('ğŸ“‹ tbody ì°¾ìŒ:', tbody !== null);
    if (!tbody) {
        console.error('âŒ tbodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤! í…Œì´ë¸”ì´ ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    }
    
    // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    const urlParams = new URLSearchParams(window.location.search);
    const pageNum = parseInt(urlParams.get('pageNum') || '1');
    const pageSize = parseInt(urlParams.get('pageSize') || '20');
    const category = urlParams.get('category') || 'all';
    const sido = urlParams.get('sido') || 'ì„œìš¸íŠ¹ë³„ì‹œ';
    
    console.log('ğŸ“‹ URL íŒŒë¼ë¯¸í„°:', { pageNum, pageSize, category, sido });
    
    // í˜„ì¬ í˜ì´ì§€ íƒ€ì… í™•ì¸
    const isNewItemsPage = window.location.pathname.includes('/new-items');
    const isDiscountPage = window.location.pathname.includes('/discount-50');
    
    console.log('ğŸ“‹ í˜ì´ì§€ íƒ€ì…:', { 
        pathname: window.location.pathname,
        isNewItemsPage, 
        isDiscountPage 
    });
    
    // API ì—”ë“œí¬ì¸íŠ¸ ê²°ì •
    let apiUrl = '/items/api/all-items';
    if (isNewItemsPage) {
        apiUrl = '/items/api/new-items';
    } else if (isDiscountPage) {
        // ê°ê°€ 50% ë¬¼ê±´ì€ ì•„ì§ API ì—”ë“œí¬ì¸íŠ¸ê°€ ì—†ìœ¼ë¯€ë¡œ ì „ì²´ ê²½ë§¤ë¬¼ê±´ ì‚¬ìš©
        apiUrl = '/items/api/all-items';
    }
    
    console.log('ğŸ“‹ ì„ íƒëœ API URL:', apiUrl);
    
    // API í˜¸ì¶œ
    const apiParams = new URLSearchParams({
        page: pageNum,
        pageSize: pageSize,
        sido: sido
    });
    
    if (!isNewItemsPage && category && category !== 'all') {
        apiParams.append('category', category);
    }
    
    const fullUrl = apiUrl + '?' + apiParams.toString();
    console.log('ğŸš€ ë¹„ë™ê¸° ë°ì´í„° ë¡œë“œ ì‹œì‘:', fullUrl);
    
    fetch(apiUrl + '?' + apiParams.toString())
        .then(response => {
            console.log('ğŸ“¡ API ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('âœ… ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', data);
            console.log('ğŸ“Š ì‘ë‹µ ë°ì´í„° ìƒì„¸:', {
                success: data.success,
                atListLength: data.atList ? data.atList.length : 0,
                itemsLength: data.items ? data.items.length : 0,
                totalCount: data.totalCount,
                message: data.message
            });
            
            // atList ë˜ëŠ” items ì¤‘ ì‚¬ìš© ê°€ëŠ¥í•œ ê²ƒ ì‚¬ìš©
            const itemsToDisplay = data.atList || data.items || [];
            
            if (data.success && itemsToDisplay && itemsToDisplay.length > 0) {
                console.log('âœ… ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë¨: ' + itemsToDisplay.length + 'ê°œ');
                console.log('ğŸ“‹ ì²« ë²ˆì§¸ ì•„ì´í…œ ìƒ˜í”Œ:', itemsToDisplay[0]);
                // í…Œì´ë¸” ì—…ë°ì´íŠ¸
                updateTable(itemsToDisplay);
                
                // í˜ì´ì§€ë„¤ì´ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸
                updatePagination(data);
                
                // ê²€ìƒ‰ ì¡°ê±´ ì—…ë°ì´íŠ¸
                updateSearchSummary(data);
            } else if (data.success && itemsToDisplay.length === 0) {
                console.warn('âš ï¸ ì„±ê³µí–ˆì§€ë§Œ ë°ì´í„°ê°€ ë¹„ì–´ìˆìŒ');
                updateTable([]);
                updatePagination(data);
                updateSearchSummary(data);
            } else {
                console.error('âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', data);
                console.error('âŒ ì‹¤íŒ¨ ì›ì¸:', data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜');
                showError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
            }
            
            // ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸°
            if (loadingOverlay) {
                loadingOverlay.classList.remove('show');
            }
        })
        .catch(error => {
            console.error('âŒ AJAX ì˜¤ë¥˜:', error);
            console.error('âŒ ì˜¤ë¥˜ ìƒì„¸:', {
                message: error.message,
                stack: error.stack
            });
            showError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            
            // ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸°
            if (loadingOverlay) {
                loadingOverlay.classList.remove('show');
            }
        });
}

// í…Œì´ë¸” ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateTable(atList) {
    console.log('ğŸ“‹ updateTable í˜¸ì¶œë¨: atList.length =', atList ? atList.length : 0);
    
    const tbody = document.querySelector('.auction-table tbody');
    if (!tbody) {
        console.error('âŒ tbodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        return;
    }
    
    console.log('âœ… tbody ì°¾ìŒ, ê¸°ì¡´ í–‰ ì œê±° ì‹œì‘');
    
    // ê¸°ì¡´ ë‚´ìš© ì œê±° (ë¡œë”© ë©”ì‹œì§€ ì œì™¸)
    const existingRows = tbody.querySelectorAll('tr');
    console.log('ğŸ“‹ ê¸°ì¡´ í–‰ ê°œìˆ˜:', existingRows.length);
    existingRows.forEach(row => {
        if (!row.querySelector('td[colspan]')) {
            row.remove();
        }
    });
    
    if (!atList || atList.length === 0) {
        console.warn('âš ï¸ atListê°€ ë¹„ì–´ìˆìŒ');
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = '<td colspan="6" style="text-align: center; padding: 60px; color: var(--text-gray);">ì¡°íšŒëœ ë¬¼ê±´ì´ ì—†ìŠµë‹ˆë‹¤.</td>';
        tbody.appendChild(emptyRow);
        return;
    }
    
    console.log('âœ… ' + atList.length + 'ê°œ ì•„ì´í…œì„ í…Œì´ë¸”ì— ì¶”ê°€ ì‹œì‘');
    console.log('ğŸ“‹ ì²« ë²ˆì§¸ ì•„ì´í…œ ì „ì²´ ê°ì²´:', atList.length > 0 ? atList[0] : 'ì—†ìŒ');
    
    // ìƒˆ í–‰ ì¶”ê°€
    atList.forEach((item, index) => {
        const row = document.createElement('tr');
        
        // ë‚ ì§œ í¬ë§·íŒ…
        let endDateStr = '-';
        if (item.endDate) {
            const date = new Date(item.endDate);
            if (!isNaN(date.getTime())) {
                endDateStr = date.toLocaleDateString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\./g, '.').replace(/\s/g, '');
            }
        }
        
        // ê°€ê²© í¬ë§·íŒ…
        const formatPrice = (price) => {
            if (!price || price === 0) return '-';
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        };
        
        // ìœ ì°° ë°°ì§€ (ì¹´í…Œê³ ë¦¬ ì •ë³´ëŠ” data attributeì—ì„œ ê°€ì ¸ì˜¤ê¸°)
        let statusBadge = '';
        const mainContent = document.querySelector('.main-content');
        const itemCategory = mainContent ? (mainContent.dataset.category || 'all') : 'all';
        const isNewCategory = itemCategory === 'ì‹ ê·œë¬¼ê±´';
        
        if (isNewCategory && item.count === 0) {
            statusBadge = '<span class="status-badge-table new">ì‹ ê±´</span>';
        } else if (!isNewCategory && item.count === 0) {
            statusBadge = '<span class="status-badge-table" style="background: #d4edda; color: #155724;">ìœ ì°° 0íšŒ</span>';
        } else if (item.count > 0 && item.count <= 2) {
            statusBadge = '<span class="status-badge-table failed">ìœ ì°° ' + item.count + 'íšŒ</span>';
        } else if (item.count > 2) {
            statusBadge = '<span class="status-badge-table">ìœ ì°° ' + item.count + 'íšŒ</span>';
        }
        
        // ë””ë²„ê¹…: ì²« ë²ˆì§¸ ì•„ì´í…œì˜ í•„ë“œ í™•ì¸
        if (index === 0) {
            console.log('ğŸ“‹ ì²« ë²ˆì§¸ ì•„ì´í…œ í•„ë“œ:', {
                cltrNo: item.cltrNo,
                name: item.name,
                content: item.content,
                count: item.count,
                startPrice: item.startPrice,
                endPrice: item.endPrice,
                orgName: item.orgName,
                endDate: item.endDate
            });
        }
        
        row.innerHTML = `
            <td style="text-align: center;">
                <input type="checkbox" value="${item.cltrNo || ''}">
            </td>
            <td class="item-number">${index + 1}</td>
            <td>
                <div class="location-details">
                    <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 5px;">
                        <span class="usage-badge">ì˜¨ë¹„ë“œ</span>
                        <span class="case-number" style="font-size: 11px; color: #999;">ë¬¼ê±´ë²ˆí˜¸: ${item.cltrNo || ''}</span>
                    </div>
                    <a class="address" href="/api-item-detail?cltrNo=${item.cltrNo || ''}" style="cursor: pointer; text-decoration: none; color: inherit;">
                        ${item.name || ''}
                    </a>
                    ${item.content ? '<div class="building-info">' + item.content + '</div>' : ''}
                </div>
            </td>
            <td class="remarks">
                ${item.count > 0 ? '<div>â€¢ ì…ì°°ì°¸ê°€ì <span>' + item.count + '</span>ëª…</div>' : ''}
                <div>â€¢ ê³µê³µê²½ë§¤</div>
            </td>
            <td class="price-info">
                <div class="price-label">ê°ì •í‰ê°€ì•¡</div>
                <div class="price-value">${formatPrice(item.endPrice)}</div>
                <div class="price-label">ìµœì €ë§¤ê°ê°€ê²©</div>
                <div class="price-value min-price">
                    ${formatPrice(item.startPrice)}
                    ${item.endPrice > 0 && item.startPrice > 0 ? '<span class="price-percent">(' + Math.round((item.startPrice * 100) / item.endPrice) + '%)</span>' : ''}
                </div>
            </td>
            <td class="dept-info">
                <div class="dept-name">${item.orgName || 'ìº ì½”'}</div>
                <div class="auction-date">${endDateStr}</div>
                <div>${statusBadge}</div>
            </td>
        `;
        
        tbody.appendChild(row);
    });
}

// í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updatePagination(data) {
    if (!data || !data.pageCount) return;
    
    const paginationContainer = document.getElementById('paginationContainer');
    if (!paginationContainer) return;
    
    const currentPage = data.pageNum || 1;
    const totalPages = data.pageCount || 1;
    
    // í˜ì´ì§€ë„¤ì´ì…˜ HTML ìƒì„±
    let paginationHTML = '';
    
    // ì´ì „ í˜ì´ì§€ ë§í¬
    if (currentPage > 1) {
        paginationHTML += `<a class="pagination-link" data-page="1" href="javascript:void(0)">&lt;&lt;</a>`;
        paginationHTML += `<a class="pagination-link" data-page="${currentPage - 1}" href="javascript:void(0)">&lt;</a>`;
    }
    
    // í˜ì´ì§€ ë²ˆí˜¸ ë§í¬ (í˜„ì¬ í˜ì´ì§€ ê¸°ì¤€ Â±2)
    const startPage = Math.max(1, currentPage - 2);
    const endPage = Math.min(totalPages, currentPage + 2);
    
    if (startPage > 1) {
        paginationHTML += `<a class="pagination-link" data-page="1" href="javascript:void(0)">1</a>`;
        if (startPage > 2) {
            paginationHTML += `<span>...</span>`;
        }
    }
    
    for (let i = startPage; i <= endPage; i++) {
        const activeClass = i === currentPage ? 'active' : '';
        paginationHTML += `<a class="pagination-link ${activeClass}" data-page="${i}" href="javascript:void(0)">${i}</a>`;
    }
    
    if (endPage < totalPages) {
        if (endPage < totalPages - 1) {
            paginationHTML += `<span>...</span>`;
        }
        paginationHTML += `<a class="pagination-link" data-page="${totalPages}" href="javascript:void(0)">${totalPages}</a>`;
    }
    
    // ë‹¤ìŒ í˜ì´ì§€ ë§í¬
    if (currentPage < totalPages) {
        paginationHTML += `<a class="pagination-link" data-page="${currentPage + 1}" href="javascript:void(0)">&gt;</a>`;
        paginationHTML += `<a class="pagination-link" data-page="${totalPages}" href="javascript:void(0)">&gt;&gt;</a>`;
    }
    
    paginationContainer.innerHTML = paginationHTML;
    
    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ì„¤ì •
    setupPaginationListeners();
}

// ê²€ìƒ‰ ì¡°ê±´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateSearchSummary(data) {
    const summaryText = document.querySelector('.search-summary-text');
    if (summaryText && data) {
        const categoryText = data.category && data.category !== 'all' ? data.category : 'ì „ì²´';
        summaryText.innerHTML = `
            ì¹´í…Œê³ ë¦¬ <strong>${categoryText}</strong> | 
            ì´ ë¬¼ê±´ìˆ˜ <strong>${data.totalCount || 0}ê±´</strong>
        `;
    }
}

// ì—ëŸ¬ í‘œì‹œ í•¨ìˆ˜
function showError(message) {
    const tbody = document.querySelector('.auction-table tbody');
    if (tbody) {
        const errorRow = document.createElement('tr');
        errorRow.innerHTML = '<td colspan="6" style="text-align: center; padding: 60px; color: var(--text-red);">' + message + '</td>';
        tbody.appendChild(errorRow);
    }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ë ˆì´ì•„ì›ƒ ê°•ì œ ìˆ˜ì • ë° ë¹„ë™ê¸° ë°ì´í„° ë¡œë“œ
window.addEventListener('DOMContentLoaded', function() {
    console.log('=== DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ ===');
    console.log('=== ë ˆì´ì•„ì›ƒ ê°•ì œ ìˆ˜ì • ì‹œì‘ ===');
    
    // ë¹„ë™ê¸° ë¡œë”© í”Œë˜ê·¸ í™•ì¸ (data attributeì—ì„œ)
    const mainContent = document.querySelector('.main-content');
    console.log('ğŸ“‹ mainContent ì°¾ìŒ:', mainContent !== null);
    
    if (mainContent) {
        console.log('ğŸ“‹ mainContent.dataset:', mainContent.dataset);
        console.log('ğŸ“‹ mainContent.dataset.asyncLoad:', mainContent.dataset.asyncLoad);
        console.log('ğŸ“‹ mainContent.dataset.asyncLoad === "true":', mainContent.dataset.asyncLoad === 'true');
        console.log('ğŸ“‹ mainContent.getAttribute("data-async-load"):', mainContent.getAttribute('data-async-load'));
    }
    
    // ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ asyncLoad í™•ì¸
    let asyncLoad = false;
    if (mainContent) {
        const asyncLoadAttr = mainContent.getAttribute('data-async-load');
        const asyncLoadDataset = mainContent.dataset.asyncLoad;
        console.log('ğŸ“‹ asyncLoadAttr:', asyncLoadAttr, 'asyncLoadDataset:', asyncLoadDataset);
        asyncLoad = asyncLoadAttr === 'true' || asyncLoadDataset === 'true' || asyncLoadAttr === true || asyncLoadDataset === true;
    }
    
    console.log('ğŸ“‹ asyncLoad ìµœì¢… ê°’:', asyncLoad);
    
    // ê°•ì œë¡œ ë¹„ë™ê¸° ë¡œë”© ì‹œë„ (ë””ë²„ê¹…ìš©)
    // asyncLoadê°€ falseì—¬ë„ ê²½ë§¤ë¬¼ê±´ ëª©ë¡ í˜ì´ì§€ë©´ ê°•ì œë¡œ ë¡œë“œ
    const isAuctionListPage = window.location.pathname.includes('/auctionList') || 
                              window.location.pathname === '/auctionList';
    const isNewItemsPage = window.location.pathname.includes('/new-items');
    
    // ë¬´ì¡°ê±´ ë¹„ë™ê¸° ë¡œë”© ì‹œë„ (ë””ë²„ê¹…ìš©)
    console.log('ğŸš€ ë¬´ì¡°ê±´ ë¹„ë™ê¸° ë¡œë”© ì‹œì‘ - loadItemsAsync í˜¸ì¶œ ì˜ˆì •');
    console.log('ğŸ“‹ í˜ì´ì§€ ì •ë³´:', {
        pathname: window.location.pathname,
        isAuctionListPage,
        isNewItemsPage,
        asyncLoad
    });
    
    // í˜ì´ì§€ë„¤ì´ì…˜ ë§í¬ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    setupPaginationListeners();
    
    // ì¦‰ì‹œ ë°ì´í„° ë¡œë“œ ì‹œë„
    console.log('â° ì¦‰ì‹œ loadItemsAsync í˜¸ì¶œ');
    try {
        loadItemsAsync();
    } catch (error) {
        console.error('âŒ loadItemsAsync í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:', error);
    }
    
    // ì¶”ê°€ë¡œ 100ms í›„ì—ë„ ì‹œë„ (í˜¹ì‹œ ëª¨ë¥¼ íƒ€ì´ë° ì´ìŠˆ)
    setTimeout(() => {
        console.log('â° setTimeout(100ms) ì‹¤í–‰ - loadItemsAsync ì¬í˜¸ì¶œ');
        try {
            loadItemsAsync();
        } catch (error) {
            console.error('âŒ loadItemsAsync ì¬í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:', error);
        }
    }, 100);
    
    // í˜ì´ì§€ë„¤ì´ì…˜ ë§í¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    function setupPaginationListeners() {
        const paginationLinks = document.querySelectorAll('.pagination-link');
        paginationLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const page = parseInt(this.dataset.page);
                if (page && page > 0) {
                    const url = new URL(window.location);
                    url.searchParams.set('pageNum', page);
                    window.history.pushState({}, '', url.toString());
                    loadItemsAsync();
                }
            });
        });
    }
    
    // Body ìŠ¤íƒ€ì¼
    document.body.style.cssText = 'margin: 0 !important; padding: 0 !important; width: 100% !important; max-width: 100vw !important; overflow-x: hidden !important;';
    document.documentElement.style.cssText = 'margin: 0 !important; padding: 0 !important; width: 100% !important; max-width: 100vw !important; overflow-x: hidden !important;';
    
    // List Container
    let listContainer = document.querySelector('.list-container');
    if (listContainer) {
        listContainer.style.cssText = 'margin: 0 auto !important; padding: 20px 40px !important; display: flex !important; gap: 30px !important; width: 100% !important; max-width: 1400px !important;';
        console.log('List container width:', listContainer.offsetWidth);
    }
    
    // Main Content
    let mainContent = document.querySelector('.main-content');
    if (mainContent) {
        mainContent.style.cssText = 'background: #fff !important; border: 1px solid #ddd !important; border-radius: 0 !important; flex: 1 !important; min-width: 0 !important; width: 100% !important;';
        console.log('Main content width:', mainContent.offsetWidth);
    }
    
    // Table Container
    let tableContainer = document.querySelector('.table-container');
    if (tableContainer) {
        tableContainer.style.cssText = 'padding: 25px !important; width: 100% !important; max-width: none !important;';
        console.log('Table container width:', tableContainer.offsetWidth);
    }
    
    // Table
    let table = document.querySelector('.auction-table');
    if (table) {
        table.style.cssText = 'width: 100% !important; max-width: none !important; min-width: 100% !important; border-collapse: collapse !important; table-layout: fixed !important;';
        console.log('Table width:', table.offsetWidth);
    }
    
    console.log('Window width:', window.innerWidth);
    console.log('=== ë ˆì´ì•„ì›ƒ ê°•ì œ ìˆ˜ì • ì™„ë£Œ ===');
});

// ì „ì²´ ì„ íƒ
document.getElementById('selectAll')?.addEventListener('change', function() {
    const checkboxes = document.querySelectorAll('.auction-table tbody input[type="checkbox"]');
    checkboxes.forEach(cb => cb.checked = this.checked);
});

// í˜ì´ì§€ í¬ê¸° ë³€ê²½
function changePageSize(size) {
    const url = new URL(window.location);
    url.searchParams.set('pageSize', size);
    url.searchParams.set('pageNum', '1');
    
    // ë¹„ë™ê¸° ë¡œë”©ì¸ ê²½ìš° AJAXë¡œ ë¡œë“œ
    const mainContent = document.querySelector('.main-content');
    const asyncLoad = mainContent && mainContent.dataset.asyncLoad === 'true';
    
    if (asyncLoad) {
        // URL ì—…ë°ì´íŠ¸ (íˆìŠ¤í† ë¦¬ ë³€ê²½)
        window.history.pushState({}, '', url.toString());
        loadItemsAsync();
    } else {
    window.location.href = url.toString();
    }
}

// ë¬¼ê±´ ë¹„êµ
function compareItems() {
    const selected = Array.from(document.querySelectorAll('.auction-table tbody input[type="checkbox"]:checked'))
        .map(cb => cb.value);
    
    if (selected.length === 0) {
        alert('ë¹„êµí•  ë¬¼ê±´ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
    }
    
    if (selected.length > 5) {
        alert('ìµœëŒ€ 5ê°œê¹Œì§€ ë¹„êµ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return;
    }
    
    alert(`${selected.length}ê°œ ë¬¼ê±´ ë¹„êµ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.`);
}

// ê´€ì‹¬ë¬¼ê±´ ë“±ë¡ (ì—¬ëŸ¬ ê°œ)
function addToFavoritesMultiple() {
    // ì¦‰ì‹œ í™•ì¸: í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ”ì§€
    alert('ê´€ì‹¬ë¬¼ê±´ ë“±ë¡ í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤! (ë””ë²„ê¹…ìš©)');
    
    console.log('========================================');
    console.log('=== ê´€ì‹¬ë¬¼ê±´ ë“±ë¡ (ì—¬ëŸ¬ ê°œ) í•¨ìˆ˜ í˜¸ì¶œ ===');
    console.log('========================================');
    
    // jQuery í™•ì¸
    if (typeof jQuery === 'undefined' && typeof $ === 'undefined') {
        alert('jQueryê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        console.error('âŒ jQueryê°€ ì—†ìŠµë‹ˆë‹¤!');
        return;
    }
    const $ = window.jQuery || window.$;
    console.log('âœ… jQuery í™•ì¸ë¨');
    
    // ì„ íƒëœ ì²´í¬ë°•ìŠ¤ ì°¾ê¸°
    const checkboxes = document.querySelectorAll('.auction-table tbody input[type="checkbox"]:checked');
    console.log('ì„ íƒëœ ì²´í¬ë°•ìŠ¤ ê°œìˆ˜:', checkboxes.length);
    
    if (checkboxes.length === 0) {
        alert('ê´€ì‹¬ë¬¼ê±´ìœ¼ë¡œ ë“±ë¡í•  ë¬¼ê±´ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
    }
    
    // ì²´í¬ë°•ìŠ¤ì˜ value ê°’ í™•ì¸
    const selected = [];
    checkboxes.forEach((cb, idx) => {
        const value = cb.value;
        console.log(`ì²´í¬ë°•ìŠ¤ [${idx}]: value="${value}"`);
        if (value && value !== '' && value !== 'null') {
            selected.push(value);
        }
    });
    
    console.log('ì„ íƒëœ cltrNo ëª©ë¡:', selected);
    
    if (selected.length === 0) {
        alert('ìœ íš¨í•œ ë¬¼ê±´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì²´í¬ë°•ìŠ¤ì˜ ê°’ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
        console.error('âŒ ì„ íƒëœ ê°’ì´ ì—†ìŒ');
        return;
    }
    
    if (!confirm(`${selected.length}ê°œ ë¬¼ê±´ì„ ê´€ì‹¬ë¬¼ê±´ìœ¼ë¡œ ë“±ë¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        return;
    }
    
    console.log('ì¦ê²¨ì°¾ê¸° ì¶”ê°€ ì‹œì‘ - ê°œìˆ˜:', selected.length);
    
    // ê° cltrNoì— ëŒ€í•´ ì¦ê²¨ì°¾ê¸° ì¶”ê°€ ìš”ì²­
    let successCount = 0;
    let failCount = 0;
    let completedCount = 0;
    const errors = [];
    
    selected.forEach((cltrNo, index) => {
        console.log(`[${index + 1}/${selected.length}] cltrNo="${cltrNo}" ì¦ê²¨ì°¾ê¸° ì¶”ê°€ ì‹œë„`);
        
        $.ajax({
            url: '/api/favorites',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ cltrNo: cltrNo }),
            timeout: 15000,
            beforeSend: function() {
                console.log(`[${index + 1}/${selected.length}] AJAX ìš”ì²­ ì „ì†¡ ì‹œì‘`);
            },
            success: function(response) {
                completedCount++;
                console.log(`[${index + 1}/${selected.length}] ì‘ë‹µ ë°›ìŒ:`, response);
                
                if (response && response.success === true) {
                    successCount++;
                    console.log(`âœ… [${index + 1}/${selected.length}] ì„±ê³µ: cltrNo=${cltrNo}`);
                } else {
                    failCount++;
                    const msg = response && response.message ? response.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
                    errors.push(`cltrNo ${cltrNo}: ${msg}`);
                    console.error(`âŒ [${index + 1}/${selected.length}] ì‹¤íŒ¨:`, response);
                }
                
                // ëª¨ë“  ìš”ì²­ ì™„ë£Œ í›„ ê²°ê³¼ í‘œì‹œ
                if (completedCount === selected.length) {
                    console.log('========================================');
                    console.log('ëª¨ë“  ìš”ì²­ ì™„ë£Œ - ì„±ê³µ:', successCount, 'ì‹¤íŒ¨:', failCount);
                    console.log('========================================');
                    
                    if (successCount === selected.length) {
                        alert(`âœ… ${successCount}ê°œ ë¬¼ê±´ì´ ê´€ì‹¬ë¬¼ê±´ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                    } else if (successCount > 0) {
                        alert(`âš ï¸ ${successCount}ê°œ ì„±ê³µ, ${failCount}ê°œ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\nì‹¤íŒ¨í•œ í•­ëª©:\n${errors.join('\n')}`);
                    } else {
                        alert(`âŒ ê´€ì‹¬ë¬¼ê±´ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜:\n${errors.join('\n')}`);
                    }
                }
            },
            error: function(xhr, status, error) {
                completedCount++;
                failCount++;
                const errorMsg = xhr.responseJSON && xhr.responseJSON.message 
                    ? xhr.responseJSON.message 
                    : `HTTP ${xhr.status}: ${error}`;
                errors.push(`cltrNo ${cltrNo}: ${errorMsg}`);
                console.error(`âŒ [${index + 1}/${selected.length}] AJAX ì˜¤ë¥˜:`, xhr.status, error);
                console.error('ì‘ë‹µ:', xhr.responseText);
                
                // ëª¨ë“  ìš”ì²­ ì™„ë£Œ í›„ ê²°ê³¼ í‘œì‹œ
                if (completedCount === selected.length) {
                    console.log('========================================');
                    console.log('ëª¨ë“  ìš”ì²­ ì™„ë£Œ - ì„±ê³µ:', successCount, 'ì‹¤íŒ¨:', failCount);
                    console.log('========================================');
                    
                    if (successCount > 0) {
                        alert(`âš ï¸ ${successCount}ê°œ ì„±ê³µ, ${failCount}ê°œ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\nì‹¤íŒ¨í•œ í•­ëª©:\n${errors.join('\n')}`);
                    } else {
                        if (xhr.status === 401 || xhr.status === 403) {
                            alert('ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.');
                            window.location.href = '/memberLogin';
                        } else {
                            alert(`âŒ ê´€ì‹¬ë¬¼ê±´ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜:\n${errors.join('\n')}`);
                        }
                    }
                }
            }
        });
    });
}

// ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™
function goToPayment(id) {
    if (!id) {
        alert('ê²½ë§¤ ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
    }
    // ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™ (itemIdë¡œ ì „ë‹¬)
    window.location.href = '/payment/checkout?itemId=' + id;
}

// ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ í›„ ì´ë™
function checkLoginAndNavigate(url) {
    const isLogin = document.getElementById('isLogin');
    if (isLogin && isLogin.value === 'true') {
        window.location.href = url;
    } else {
        alert('ë¡œê·¸ì¸ í›„ ì´ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤');
    }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ë‚˜ì˜ê²½ë§¤ ë²„íŠ¼ì´ í•­ìƒ ë³´ì´ë„ë¡ ê°•ì œ
document.addEventListener('DOMContentLoaded', function() {
    const myAuctionLinks = document.querySelectorAll('a[onclick*="checkLoginAndNavigate"]');
    myAuctionLinks.forEach(function(link) {
        link.style.display = 'inline-block';
        link.style.visibility = 'visible';
        link.style.opacity = '1';
    });
});
</script>

</body>
</html>
